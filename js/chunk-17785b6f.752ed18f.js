(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17785b6f"],{"0f0c":function(t,e,i){},"13ad":function(t,e,i){},"32ae":function(t,e,i){},"3eb8":function(t,e,i){},4015:function(t,e,i){},"498a":function(t,e,i){"use strict";var n=i("23e7"),a=i("58a8").trim,s=i("c8d2");n({target:"String",proto:!0,forced:s("trim")},{trim:function(){return a(this)}})},"4e44":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-mall-web"},[e("SearchBox"),e("GoodList",{attrs:{list:t.list}}),e("Nav")],1)},a=[],s=i("5530"),o=(i("d81d"),i("e9f5"),i("7d54"),i("ab43"),i("d3b7"),i("159b"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"search-bar"},[e("div",{staticClass:"select-box"},[e("i",{staticClass:"el-icon-s-unfold",staticStyle:{"font-size":"5.3333vw"},on:{click:function(e){return t.$store.commit("mallNew/toState",{navIsShow:!0})}}}),e("div",{staticClass:"select-item"},[e("el-select",{attrs:{value:t.c_level,placeholder:"等级限制"},on:{change:function(e){return t.handleChange(e,"level")}}},t._l(t.level_options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("div",{staticClass:"select-item"},[e("el-select",{attrs:{value:t.query.vip_limit,placeholder:"会员限制"},on:{change:function(e){return t.handleChange(e,"vip_limit")}}},t._l(t.member_options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),e("div",{staticClass:"search-input"},[e("el-input",{attrs:{value:t.query.title,placeholder:"搜索商品关键词"},on:{input:function(e){return t.handleChange(e,"title")}}},[e("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1)])}),l=[],r=(i("498a"),{name:"SearchBox",inject:["query","changeQuery"],data:function(){return{level:"",vip_limit:"",title:"",level_options:[{value:0,label:"全部"},{value:1,label:"lv.1"},{value:2,label:"lv.2"},{value:3,label:"lv.3"},{value:4,label:"lv.4"},{value:5,label:"lv.5"},{value:6,label:"lv.6"}],member_options:[{value:-1,label:"全部"},{value:1,label:"会员限制"},{value:0,label:"非会员限制"}]}},computed:{c_level:{get:function(){return null===this.query.level?"":0===this.query.level?"全部":"等级：lv."+this.query.level}}},methods:{handleChange:function(t,e){switch(e){case"level":this.changeQuery("level",t);break;case"vip_limit":this.changeQuery("vip_limit",t);break;case"title":this.changeQuery("title",t.trim());break}}}}),c=r,u=(i("6e7e"),i("2877")),d=Object(u["a"])(c,o,l,!1,null,"33eadd5e",null),v=d.exports,h=function(){var t=this,e=t._self._c;return e("div",{ref:"goodList",staticClass:"m-good-list"},t._l(t.list,(function(t){return e("GoodItem",{key:t.id,attrs:{good:t}})})),1)},m=[],f=i("2ef0"),p=(i("14d9"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"good-item",on:{click:function(e){return t.$router.push({name:"mall_detail_web",params:{id:t.good.id}})}}},[e("img",{staticClass:"good-item-img",attrs:{src:t.good.goods_images[0],alt:""}}),e("div",{staticClass:"right"},[e("div",{staticClass:"header"},[e("div",{staticClass:"title"},[t._v(t._s(t.good.title))]),t.good.subtitle?e("div",{staticStyle:{width:"100%",display:"flex"}},[e("div",{staticClass:"sub-title"},[t._v(t._s(t.good.subtitle))])]):t._e(),e("div",{staticClass:"tags"},[e("div",{staticClass:"tag"},[t._v("lv."+t._s(t.getLevel(t.good.exp_limit)))]),1===t.good.vip_limit?e("div",{staticClass:"tag"},[t._v("会员专享")]):t._e()])]),e("div",{staticClass:"footer"},[e("button",{class:{button:!0,canBuy:t.good.canBuy.canBuy},attrs:{disabled:!t.good.canBuy.canBuy},on:{click:function(e){return e.stopPropagation(),t.buyGoods(t.good)}}},[t.good.canBuy.canBuy?e("div",{staticClass:"button-text canBuy"},[t.good.price_boxcoin?[e("svg",{style:"fill: white; margin-right: 0.6vw; width: 3.2vw; height: 3.2vw",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"10.392",height:"12",viewBox:"0 0 10.392 12",fill:"rgba(64, 128, 255, 1)","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M10.392 3v6l-5.196 3L0 9V3l5.196-3 5.196 3zm-5.196-.69l3.196 1.845v3.69L5.196 9.691 2 7.845v-3.69l3.196-1.846z"}})]),t._v(t._s(t.good.price_boxcoin)+"盒币 ")]:t._e(),t.good.price_boxcoin&&t.good.price_points?[t._v(" + ")]:t._e(),t.good.price_points?[e("svg",{style:"fill: white; margin-right: 0.6vw; width: 3.2vw; height: 3.2vw",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"12",viewBox:"0 0 10 12",fill:"#7478ed","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{attrs:{d:"M10 5A5 5 0 100 5v5h3a2 2 0 104 0h3V5zM8 8V5a3 3 0 00-6 0v3h6z","fill-rule":"evenodd"}})]),t._v(t._s(t.good.price_points)+"积分 ")]:t._e()],2):e("div",{staticClass:"button-text"},[t._v("不满足兑换条件")])]),t.good.canBuy.canBuy?e("div",{staticClass:"icon",on:{click:function(e){return e.stopPropagation(),t.addCart.apply(null,arguments)}}},[e("img",{attrs:{src:t.imgUrl+"cart.svg",alt:""}})]):t._e()])]),e("BuyConfirm",{ref:"buyConfirm",attrs:{item:t.good}})],1)}),g=[],y=(i("99af"),i("7db0"),i("f665"),i("c9d2")),_=i("d09f"),b={name:"GoodItem",components:{BuyConfirm:_["a"]},data:function(){return{imgUrl:"https://cdn.jx3box.com/design/mall/"}},props:{good:{type:Object,required:!0}},methods:{getLevel:function(t){return y["a"].getLevel(t)},buyGoods:Object(f["throttle"])((function(){this.$refs.buyConfirm.isShow=!0}),2e3),addCart:Object(f["throttle"])((function(t){var e,i,n=this,a=(null===(e=this.$store.state.mall.cart)||void 0===e||null===(i=e.find((function(t){return t.goods_id===n.good.id})))||void 0===i?void 0:i.amount)||0;if(1+a>this.good.stock)return this.$message({type:"warning",message:"可兑换库存不足"});this.$store.dispatch("mallNew/addCart",{id:this.good.id,amount:1}).then((function(e){e&&n.fly(t)}))}),1e3),fly:function(t){var e="IMG"===t.target.tagName?t.target.parentElement:t.target,i=e.parentElement,n=e.getBoundingClientRect(),a=n.left,s=n.top,o=this.$store.state.mallNew.boundCart,l=o.left,r=o.top,c=e.cloneNode(!0);c.style.cssText="\n                position: fixed;\n                left: ".concat(a,"px;\n                top: ").concat(s,"px;\n                z-index: 1000;\n            "),i.appendChild(c),c.animate([{transform:"translate(".concat(l-a,"px, ").concat(r-s,"px)")}],{duration:500,easing:"ease-in-out",fill:"forwards"}),setTimeout((function(){i.removeChild(c)}),500)}}},w=b,k=(i("805e"),Object(u["a"])(w,p,g,!1,null,"3d4ad51c",null)),C=k.exports,x={name:"GoodList",components:{GoodItem:C},inject:["changeQuery","query"],props:{list:{type:Array,default:function(){return[]}}},methods:{handleScroll:Object(f["throttle"])((function(){var t=this.$refs.goodList;t.scrollTop+t.clientHeight>=t.scrollHeight-200&&this.changeQuery("pageSize",this.query.pageSize+10)}),500)},mounted:function(){this.$refs.goodList.addEventListener("scroll",this.handleScroll)},beforeDestroy:function(){this.$refs.goodList.removeEventListener("scroll",this.handleScroll)}},B=x,q=(i("fafb"),Object(u["a"])(B,h,m,!1,null,"19e660e0",null)),S=q.exports,L=i("015f"),j=i("65c2"),O=(i("b0c0"),i("9911"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-mall-types",class:{isShow:t.$store.state.mallNew.navIsShow}},[e("div",{staticClass:"close-icon",on:{click:function(e){return t.$store.commit("mallNew/toState",{navIsShow:!1})}}},[e("i",{staticClass:"el-icon-s-fold"})]),t._l(t.types,(function(i,n){return e("div",{key:n,staticClass:"u-item"},["system"!=i.key?e("div",{class:{"u-title":!0,active:t.query.category==i.key},on:{click:function(e){return t.itemLinkClick(i.key)}}},[e("i",{staticClass:"u-icon",class:i.icon}),t._v(" "+t._s(i.name)+" ")]):e("span",{staticClass:"u-title",class:t.query.category==i.key?"active":"",staticStyle:{cursor:"default"}},[e("i",{staticClass:"u-icon",class:i.icon}),t._v(" "+t._s(i.name))]),"system"!=i.key?e("div",{staticClass:"u-children-list"},t._l(i.sub_category,(function(n,a){return e("div",{key:a,class:{"u-child":!0,active:t.query.sub_category==n.key},on:{click:function(e){return t.childLinkClick(i.key,n.key)}}},[e("i",{staticClass:"u-arrow el-icon-caret-right"}),t._v(" "+t._s(n.name)+" ")])})),0):e("div",{staticClass:"u-children-list"},t._l(i.sub_category,(function(i,n){return e("a",{key:n,staticClass:"u-child",class:t.query.sub_category==i.key||t.query.sub_category==i.key?"active":"",attrs:{href:i.link,target:i.target}},[e("i",{staticClass:"u-arrow el-icon-caret-right"}),t._v(" "+t._s(i.name)+" ")])})),0)])}))],2)}),$=[],z=i("6622"),Q={name:"Nav",data:function(){return{types:z}},inject:["query","changeQuery"],methods:{itemLinkClick:function(t){this.changeQuery(["category","sub_category"],[t,""])},childLinkClick:function(t,e){this.changeQuery(["category","sub_category"],[t,e])},handleCurrentChange:function(t){this.changeQuery("pageIndex",t,!0)}}},I=Q,N=(i("a1d31"),Object(u["a"])(I,O,$,!1,null,"58dee3e4",null)),G=N.exports,E={name:"Index",data:function(){return{query:{pageSize:10,pageIndex:1,level:null,vip_limit:null,title:"",category:"",sub_category:"",total:0},goodsList:[]}},components:{SearchBox:v,GoodList:S,Nav:G},provide:function(){return{query:this.query,changeQuery:this.changeQuery}},computed:{asset:function(){return this.$store.state.mallNew.asset},list:function(){var t,e=this;return null===(t=this.goodsList)||void 0===t?void 0:t.map((function(t){return Object(s["a"])(Object(s["a"])({},t),{},{canBuy:e.checkCanBuy(t)})}))}},methods:{buildQuery:function(){var t={};for(var e in this.query){var i,n;if(void 0!==this.query[e]&&""!==this.query[e]&&null!==this.query[e])if("level"===e&&0!=this.query.level)t.exp_limit=null===(i=j["__userLevel"][this.query.level])||void 0===i?void 0:i[0],t.exp_limit_max=(null===(n=j["__userLevel"][this.query.level])||void 0===n?void 0:n[1])-1||"";else t[e]=this.query[e]}return delete t.total,t},loadData:function(){var t=this,e=this.buildQuery();Object(L["e"])(e).then((function(e){var i,n;t.goodsList=(null===(i=e.data.data)||void 0===i?void 0:i.list)||[],t.query.total=(null===(n=e.data.data.page)||void 0===n?void 0:n.total)||0,e.data.data.page&&(t.query.pageIndex=e.data.data.page.index,t.query.pageSize=e.data.data.page.pageSize)}))},changeQuery:function(t,e,i){var n=this;Array.isArray(t)?t.forEach((function(t,i){n.query[t]=e[i]})):this.query[t]=e,i||(this.query.pageIndex=1),this.loadData()},checkCanBuy:function(t){var e={canBuy:!0,vip_limit:!0,box_coin:!0,points:!0,level:!0,user_level:y["a"].getLevel(t.exp_limit),buy_time:!0};return 1!==t.vip_limit||y["a"]._isPRO(this.asset)||(e.canBuy=!1,e.vip_limit=!1),this.asset.box_coin<t.price_boxcoin&&(e.canBuy=!1,e.box_coin=!1),this.asset.points<t.price_points&&(e.canBuy=!1,e.points=!1),this.asset.experience<t.exp_limit&&(e.canBuy=!1,e.level=!1),0===t.on_selling&&(e.canBuy=!1,e.buy_time=!1),e},getBoundCart:Object(f["debounce"])((function(){var t=document.getElementById("cartBtn").getBoundingClientRect(),e=t.left,i=t.top;this.$store.dispatch("mallNew/setBoundCart",{left:e,top:i})}),500)},created:function(){this.loadData()},mounted:function(){this.getBoundCart(),window.addEventListener("resize",this.getBoundCart)},beforeDestroy:function(){window.removeEventListener("resize",this.getBoundCart)}},T=E,P=(i("88bc"),Object(u["a"])(T,n,a,!1,null,"77790217",null));e["default"]=P.exports},6622:function(t){t.exports=JSON.parse('[{"name":"全部","key":"","icon":"el-icon-menu"},{"name":"实物","key":"entity","icon":"el-icon-s-goods","sub_category":[{"name":"定制纪念品","key":"jdt"},{"name":"其它","key":"other"}]},{"name":"虚拟","key":"virtual","icon":"el-icon-s-ticket","sub_category":[{"name":"主题装扮","key":"skin"},{"name":"魔卡","key":"palu"},{"name":"头像框","key":"avatar"},{"name":"表情包","key":"emotion"}]},{"name":"系统","key":"system","icon":"el-icon-s-finance","sub_category":[{"name":"专业版","key":"vip","link":"/vip/premium","target":"_blank"},{"name":"改名卡","key":"rename2","link":"/vip/rename","target":"_blank"},{"name":"铭牌","key":"namespace2","link":"/vip/namespace","target":"_blank"},{"name":"点月卡","key":"dianyueka","link":"https://charge.xoyo.com/pay?item=jx3&__from=jx3box","target":"_blank"}]}]')},"6e7e":function(t,e,i){"use strict";i("32ae")},"805e":function(t,e,i){"use strict";i("3eb8")},"88bc":function(t,e,i){"use strict";i("13ad")},a064:function(t,e,i){"use strict";i("4015")},a1d31:function(t,e,i){"use strict";i("e114")},c8d2:function(t,e,i){"use strict";var n=i("5e77").PROPER,a=i("d039"),s=i("5899"),o="​᠎";t.exports=function(t){return a((function(){return!!s[t]()||o[t]()!==o||n&&s[t].name!==t}))}},d09f:function(t,e,i){"use strict";var n=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{visible:t.isShow,width:"77.3333vw","show-close":!1,"custom-class":"m-buy-confirm"},on:{"update:visible":function(e){t.isShow=e}}},[e("div",{staticClass:"content"},[e("img",{staticStyle:{width:"32vw",height:"32vw"},attrs:{src:t.item.goods_images[0],alt:""}}),e("div",{staticClass:"text"},[t._v(" 确认使用"),e("span",{staticClass:"price"},[t._v(t._s(t.confirmText))]),t._v("兑换"),e("span",{staticClass:"title"},[t._v(t._s(t.item.title))]),t._v("嘛？ ")])]),e("div",{staticClass:"btn-box"},[e("el-button",{staticStyle:{width:"20.5333vw","font-size":"3.2vw"},attrs:{round:"",size:"mini"},on:{click:function(e){e.stopPropagation(),t.isShow=!1}}},[t._v("取消")]),e("el-button",{staticStyle:{width:"20.5333vw","font-size":"3.2vw"},attrs:{type:"primary",round:"",size:"mini"},on:{click:function(e){return e.stopPropagation(),t.buyGoods.apply(null,arguments)}}},[t._v("确定")])],1)])},a=[],s=(i("99af"),i("14d9"),i("c9d2")),o={name:"BuyConfirm",props:{item:{type:Object,default:function(){}}},data:function(){return{isShow:!1}},computed:{confirmText:function(){return this.item.price_points&&this.item.price_boxcoin?"".concat(this.item.price_boxcoin,"盒币和").concat(this.item.price_points,"积分"):this.item.price_points?"".concat(this.item.price_points,"积分"):this.item.price_boxcoin?"".concat(this.item.price_boxcoin,"盒币"):""}},methods:{buyGoods:function(){var t=this;if(!s["a"].isLogin())return this.$message.error("请先登录"),void setTimeout((function(){s["a"].toLogin()}),1e3);this.isShow=!1;var e=this.item,i=e.category,n=e.is_virtual,a=e.id;if(n&&"virtual"==i)return this.$store.dispatch("mallNew/buyGoods",{id:a,count:1,addressId:0,remark:"虚拟商品购买"}).then((function(e){t.$confirm("购买成功，是否跳转至订单界面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e="".concat(t.root,"dashboard/mall");window.open(e)})).catch((function(){}))}));this.$router.push({name:"mall_order_new",params:{id:a}})}}},l=o,r=(i("a064"),i("2877")),c=Object(r["a"])(l,n,a,!1,null,"da60ffc0",null);e["a"]=c.exports},e114:function(t,e,i){},fafb:function(t,e,i){"use strict";i("0f0c")}}]);