(function(t){function e(e){for(var i,r,o=e[0],l=e[1],c=e[2],d=0,p=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&p.push(s[r][0]),s[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);u&&u(e);while(p.length)p.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],i=!0,o=1;o<a.length;o++){var l=a[o];0!==s[l]&&(i=!1)}i&&(n.splice(e--,1),t=r(r.s=a[0]))}return t}var i={},s={login:0},n=[];function r(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=i,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(a,i,function(e){return t[e]}.bind(null,i));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="https://cdn.jx3box.com/static/uc/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;n.push([4,"chunk-vendors","chunk-common"]),a()})({4:function(t,e,a){t.exports=a("90c8")},"90c8":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("2b0e"),s=a("5c96"),n=a.n(s),r=(a("6b30"),a("c5b4"),a("0af6")),o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-card",attrs:{id:"app"}},[e("el-card",{staticClass:"box-card"},[e("CardHeader"),e("Msg"),!t.isLogin||t.isAlternate?[null==t.success?e("main",{staticClass:"m-main"},[e("form",{ref:"loginForm"},[e("div",{staticClass:"u-email"},[e("el-input",{staticClass:"u-text u-email",attrs:{placeholder:"邮箱地址",minlength:"3",maxlength:"50"},on:{change:t.checkEmail},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}},[e("template",{slot:"prepend"},[e("i",{staticClass:"el-icon-message"})])],2),e("div",{staticClass:"u-tip"},[e("el-alert",{directives:[{name:"show",rawName:"v-show",value:0==t.email_validate,expression:"email_validate == false"}],attrs:{title:t.email_validate_tip,type:"error","show-icon":"",closable:!1}})],1)],1),e("div",{staticClass:"u-pass"},[e("el-input",{staticClass:"u-text",attrs:{placeholder:"输入密码","show-password":""},on:{input:t.checkPass},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit.apply(null,arguments)}},model:{value:t.pass,callback:function(e){t.pass=e},expression:"pass"}},[e("template",{slot:"prepend"},[e("i",{staticClass:"el-icon-lock"})])],2),e("div",{staticClass:"u-tip"},[e("el-alert",{directives:[{name:"show",rawName:"v-show",value:0==t.pass_validate,expression:"pass_validate == false"}],attrs:{title:t.pass_validate_tip,type:"error","show-icon":"",closable:!1}})],1)],1),e("el-button",{staticClass:"u-submit u-button",attrs:{type:"primary"},on:{click:t.submit}},[t._v("登录")])],1),e("Union",{attrs:{mode:"login",includes:["qq","wechat","weibo"]}}),e("footer",{staticClass:"m-footer"},[e("p",{staticClass:"u-login"},[t._v(" 还没有账号? "),e("a",{attrs:{href:t.register_url}},[t._v("立即注册 »")])]),e("p",{staticClass:"u-resetpwd"},[e("a",{attrs:{href:t.reset_url}},[t._v("忘记密码?")])])])],1):t._e(),1==t.success?e("main",{staticClass:"m-main"},[e("el-alert",{attrs:{title:"登录成功",type:"success",description:"欢迎回来(#^.^#)","show-icon":"",closable:!1}}),e("a",{staticClass:"u-skip el-button u-button el-button--primary",attrs:{href:t.redirect}},[t._v(t._s(t.redirect_button))])],1):t._e(),0==t.success?e("main",{staticClass:"m-main"},[e("el-alert",{attrs:{title:"登录失败",type:"error",description:t.errors,"show-icon":"",closable:!1}}),e("el-button",{staticClass:"u-button u-submit",attrs:{type:"primary"},on:{click:t.reset}},[t._v("返回")])],1):t._e()]:[e("div",{staticClass:"m-login-in"},[e("el-alert",{staticClass:"u-current-info",attrs:{type:"warning","show-icon":"",closable:!1,center:""}},[e("span",{attrs:{slot:"title"},slot:"title"},[t._v("已登录为 "),e("b",[t._v(t._s(t.username))])])]),e("el-button",{staticClass:"u-logout",attrs:{type:"danger",size:"medium"},on:{click:t.logout}},[t._v("登 出")])],1)]],2),e("Bottom")],1)},l=[],c=a("5530"),u=(a("b0c0"),a("e9c4"),a("a9e3"),a("d3b7"),a("ac1f"),a("3ca3"),a("841c"),a("ddb0"),a("9861"),a("88a7"),a("271a"),a("5494"),a("c781")),d=a("39c6"),p=a("d174"),f=a("01ea"),h=a("c9d2"),m=a("71e5"),v=a("9945"),b=v.validator,_=a("f3e4"),g={name:"Login",data:function(){return{success:null,redirect:"",redirect_button:"",errors:"未知异常",email:"",email_validate:null,email_validate_tip:"用户名有效长度为3-50个字符",pass:"",pass_validate:null,pass_validate_tip:"密码有效长度为6-50个字符",homepage:f["c"],failcount:0,faillimit:10,device_id:"",isLogin:h["a"].isLogin(),username:h["a"].getInfo().name,isAlternate:!1}},computed:{ready:function(){return this.email_validate&&this.pass_validate},register_url:function(){return f["a"].account.register+"?redirect="+this.redirect},reset_url:function(){return"/account/password_reset"}},methods:{checkEmail:function(){if(""!=this.email){var t=b(this.email,{len:[3,50]});this.email_validate=t}else this.email_validate=!1},checkPass:function(){if(""!=this.pass){var t=b(this.pass,{len:[6,50]});this.pass_validate=t}else this.pass_validate=!1},submit:function(){var t=this;this.isfrozen()||(this.ready||(this.checkPass(),this.checkEmail()),this.ready&&Object(p["b"])({email:this.email,pass:this.pass}).then((function(e){if(e.data.code)t.success=!1,t.errors=e.data.msg,t.failcount++,t.frozen();else{var a,i,s,n,r,o;t.success=!0;var l=e.data.data,u={token:l.token,uid:null===l||void 0===l||null===(a=l.user)||void 0===a?void 0:a.ID,group:(null===l||void 0===l||null===(i=l.user)||void 0===i?void 0:i.user_group)||1,name:null===l||void 0===l||null===(s=l.user)||void 0===s?void 0:s.display_name,status:null===l||void 0===l||null===(n=l.user)||void 0===n?void 0:n.user_status,bind_wx:null!==l&&void 0!==l&&null!==(r=l.user)&&void 0!==r&&r.wechat_unionid?1:0,avatar:(null===l||void 0===l||null===(o=l.user)||void 0===o?void 0:o.user_avatar)||""};h["a"].update(u).then((function(){t.isAlternate&&localStorage.setItem("jx3box-alternate-".concat(u.uid),JSON.stringify(Object(c["a"])(Object(c["a"])({},u),{},{created_at:Number(localStorage.getItem("created_at"))}))),t.skip()})).catch((function(t){alert("浏览器版本太低,不支持本站")}))}})).catch((function(e){t.success=!1,t.errors="网络异常或非法请求"})))},reset:function(){this.success=null,this.email="",this.email_validate=null,this.pass="",this.pass_validate=null},frozen:function(){this.failcount>=this.faillimit&&_.set("loginIsFrozen","true",86400)},isfrozen:function(){return this.failcount>=this.faillimit&&(this.success=!1,this.errors="失败次数过多,请24小时后再试",!0)},checkDirect:function(){var t=new URLSearchParams(document.location.search),e=t.get("redirect");e?(this.redirect=e,this.redirect_button="即将跳转"):(this.redirect=this.homepage,this.redirect_button="返回首页");var a=t.get("alternate");~~a&&(this.isAlternate=!0,sessionStorage.setItem("alternate",1))},checkDeviceID:function(){h["a"].generateFingerprint()},skip:function(){var t=this;this.redirect&&setTimeout((function(){location.href=decodeURIComponent(t.redirect)}),1200)},logout:function(){h["a"].destroy().then((function(){location.reload()}))}},filters:{},mounted:function(){this.checkDirect()},created:function(){this.checkDeviceID()},components:{CardHeader:u["a"],Union:d["a"],Msg:m["a"]}},y=g,k=(a("cb01"),a("2877")),w=Object(k["a"])(y,o,l,!1,null,null,null),C=w.exports;i["default"].config.productionTip=!1,i["default"].use(n.a),i["default"].component("Bottom",r["a"]),new i["default"]({render:function(t){return t(C)}}).$mount("#app")},a977:function(t,e,a){},cb01:function(t,e,a){"use strict";a("a977")},f3e4:function(t,e,a){function i(t,e,a){document.cookie=t+"="+e+"; Max-Age="+a}function s(t,e){document.cookie=t+"="+e+"; Max-Age=0"}function n(t){t+="=";for(var e=document.cookie.split(";"),a=0;a<e.length;a++){var i=e[a].trim();if(0==i.indexOf(t))return i.slice(t.length,t.length)}return""}a("fb6a"),a("498a"),t.exports={get:n,set:i,del:s}}});