(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-14de5f5e"],{"244d":function(t,e,a){"use strict";a.d(e,"g",(function(){return o})),a.d(e,"a",(function(){return s})),a.d(e,"n",(function(){return r})),a.d(e,"e",(function(){return i})),a.d(e,"d",(function(){return c})),a.d(e,"h",(function(){return l})),a.d(e,"o",(function(){return u})),a.d(e,"p",(function(){return p})),a.d(e,"i",(function(){return d})),a.d(e,"c",(function(){return f})),a.d(e,"m",(function(){return b})),a.d(e,"j",(function(){return y})),a.d(e,"l",(function(){return m})),a.d(e,"k",(function(){return g})),a.d(e,"b",(function(){return _})),a.d(e,"f",(function(){return h}));a("99af");var n=a("41cb");function o(t){return Object(n["$pay"])().get("/api/mall/ship-address",t)}function s(t){return Object(n["$pay"])().post("/api/mall/ship-address",t)}function r(t,e){return Object(n["$pay"])().put("/api/mall/ship-address/".concat(t),e)}function i(t){return Object(n["$pay"])().delete("/api/mall/ship-address/".concat(t))}function c(t){return Object(n["$pay"])().put("/api/mall/ship-address/default/".concat(t))}function l(t){return Object(n["$pay"])().get("/api/mall/my/orders",{params:t})}function u(t,e){return Object(n["$pay"])().put("/api/mall/my/orders/".concat(t,"/bind-address/").concat(e))}function p(t,e){return Object(n["$pay"])().put("/api/mall/my/orders/".concat(t,"/remark"),{remark:e})}function d(t){return Object(n["$pay"])().get("/api/mall/my/orders/".concat(t))}function f(t){return Object(n["$pay"])().put("/api/mall/my/orders/".concat(t,"/cancel"))}function b(t){return Object(n["$pay"])().post("/api/mall/my/orders/".concat(t,"/pay"))}function m(t){return Object(n["$pay"])().post("/api/mall/my/orders/".concat(t,"/received"))}function y(t){return Object(n["$pay"])().get("/api/mall/my/virtual_goods",{params:t})}function g(t){return Object(n["$pay"])().post("/api/mall/goods-rate",t)}function _(t,e){return Object(n["$pay"])().post("/api/mall/goods-rate/".concat(t,"/append-comments"),e)}function h(t){return Object(n["$pay"])().delete("/api/mall/goods-rate/".concat(t))}},"45a1":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-dashboard-keycode m-credit"},[e("h2",{staticClass:"u-title"},[t._m(0),e("span",{staticClass:"u-only"},[e("el-switch",{attrs:{"active-text":"仅查看未使用"},model:{value:t.onlyNew,callback:function(e){t.onlyNew=e},expression:"onlyNew"}})],1)]),e("el-alert",{staticClass:"m-boxcoin-tip",attrs:{title:"请务必妥善保管，并注意过期时间。",type:"warning","show-icon":""}},[e("div",{staticClass:"m-boxcoin-tip__content",domProps:{innerHTML:t._s(t.bread)}})]),e("div",{staticClass:"m-keycode-tab"},[e("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.tabClick},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[e("el-tab-pane",{attrs:{label:"激活码(直发)",name:"sn"},scopedSlots:t._u([{key:"label",fn:function(){return[e("span",{staticClass:"u-tab--title"},[t._v("激活码")]),t._v(" ("),e("span",{staticClass:"u-tab--desc"},[t._v("直发")]),t._v(") ")]},proxy:!0}])},[t.codeList.length?e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-table",attrs:{data:t.codeList,"show-header":"","cell-class-name":"u-table-cell","header-cell-class-name":"u-header-cell"}},[e("el-table-column",{attrs:{prop:"type",label:"类型",width:"120px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.snOptions.types[e.row.type]||e.row.type||"其他"))]}}],null,!1,249660435)}),e("el-table-column",{attrs:{prop:"subtype",label:"渠道",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.snOptions.subtypes[e.row.subtype]||"其他"))]}}],null,!1,4082255435)}),e("el-table-column",{attrs:{prop:"describe",label:"描述",width:"160px"}}),e("el-table-column",{attrs:{label:"激活码",width:"280"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"u-code"},[e("span",{staticClass:"u-txt"},[t._v(t._s(a.row.code||"****************"))]),a.row.code?e("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:""+a.row.code,expression:"'' + scope.row.code",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"u-btn",attrs:{type:"txt",size:"mini",icon:"el-icon-document-copy"}},[t._v("复制")]):e("el-button",{attrs:{type:"primary",icon:"el-icon-view",size:"mini",plain:""},on:{click:function(e){return t.getSn(a.$index,a.row)}}},[t._v("点击查看")])],1)]}}],null,!1,861861275)}),e("el-table-column",{attrs:{label:"过期时间",width:"200"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.expire_at?e("div",{staticClass:"u-time"},[e("span",{staticClass:"u-tag",class:t.compareTime(a.row.expire_at,"tag")},[t._v(t._s(t.compareTime(a.row.expire_at,"time")))]),e("span",[t._v(t._s(a.row.expire_at))])]):e("span",[t._v("-")])]}}],null,!1,3144732282)}),e("el-table-column",{attrs:{label:"发放时间",width:"200",prop:"grant_at"}}),e("el-table-column",{attrs:{prop:"remark",label:"备注",width:"200"}}),e("el-table-column",{attrs:{prop:"used_by_self",label:"是否使用"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{staticClass:"u-used",class:{"is-used":a.row.used_by_self}},[t._v(t._s(a.row.used_by_self?"是":"否"))]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:!a.row.used_by_self,expression:"!scope.row.used_by_self"}],attrs:{type:"text",size:"mini"},on:{click:function(e){return t.onSnUsedClick(a.row)}}},[t._v("（标记使用）")])]}}],null,!1,2065327103)}),e("el-table-column",{attrs:{prop:"activate_url",label:"激活地址"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("a",{attrs:{href:a.row.activate_url,target:"_blank"}},[t._v(t._s(a.row.activate_url?"前往激活":""))])]}}],null,!1,623411963)})],1):e("el-alert",{staticClass:"m-credit-null m-packet-null",attrs:{title:"没有找到任何记录",type:"info",center:"","show-icon":""}}),t.showPagination?e("el-pagination",{staticClass:"m-credit-pages",attrs:{background:"","page-size":t.per,"hide-on-single-page":!0,"current-page":t.page,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.currentChange,"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e}}}):t._e()],1),e("el-tab-pane",{attrs:{label:"激活码(积分兑换|抽奖)",name:"virtual"},scopedSlots:t._u([{key:"label",fn:function(){return[e("span",{staticClass:"u-tab--title"},[t._v("激活码")]),t._v(" ("),e("span",{staticClass:"u-tab--desc"},[t._v("积分兑换|抽奖")]),t._v(") ")]},proxy:!0}])},[t.virtualList.length?e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-table",attrs:{data:t.virtualList,"show-header":""}},[e("el-table-column",{attrs:{label:"名称",width:"120px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.goods.title||"-"))]}}],null,!1,217824814)}),e("el-table-column",{attrs:{label:"激活码",width:"330"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"u-code"},[e("span",{staticClass:"u-txt"},[t._v(t._s(a.row.code||"****************"))]),a.row.code?e("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:""+a.row.code,expression:"'' + scope.row.code",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"u-btn",attrs:{type:"txt",size:"mini",icon:"el-icon-document-copy"}},[t._v("复制")]):e("el-button",{attrs:{type:"primary",icon:"el-icon-view",size:"mini",plain:""},on:{click:function(e){return t.getVirtualCode(a.$index,a.row)}}},[t._v("点击查看")])],1)]}}],null,!1,138258122)}),e("el-table-column",{attrs:{label:"过期时间",width:"200"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.goods.expire_at?e("div",{staticClass:"u-time"},[e("span",{staticClass:"u-tag",class:t.compareTime(a.row.goods.expire_at,"tag")},[t._v(t._s(t.compareTime(a.row.goods.expire_at,"time")))]),e("span",[t._v(t._s(a.row.goods.expire_at))])]):e("span",[t._v("-")])]}}],null,!1,4212373690)}),e("el-table-column",{attrs:{label:"备注","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.goods.mark||e.row.goods.subtitle)+" ")]}}],null,!1,1263201996)}),e("el-table-column",{attrs:{prop:"used_by_self",label:"是否使用"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{staticClass:"u-used",class:{"is-used":a.row.owner.used_by_self}},[t._v(t._s(a.row.owner.used_by_self?"是":"否"))]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:!a.row.owner.used_by_self,expression:"!scope.row.owner.used_by_self"}],attrs:{type:"text",size:"mini"},on:{click:function(e){return t.onVirtualUsedClick(a.row)}}},[t._v("（标记使用）")])]}}],null,!1,119291427)}),e("el-table-column",{attrs:{prop:"activate_url",label:"激活地址"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("a",{attrs:{href:a.row.activate_url,target:"_blank"}},[t._v(t._s(a.row.activate_url?"跳转激活":"-"))])]}}],null,!1,3554909732)})],1):e("el-alert",{staticClass:"m-credit-null m-packet-null",attrs:{title:"没有找到任何记录",type:"info",center:"","show-icon":""}}),t.showPagination?e("el-pagination",{staticClass:"m-credit-pages",attrs:{background:"","page-size":t.per,"hide-on-single-page":!0,"current-page":t.page,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.currentChange,"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e}}}):t._e()],1),e("el-tab-pane",{attrs:{label:"一卡通",name:"keycode"}},[t.keycodeList.length?e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-table",attrs:{data:t.keycodeList,"show-header":""}},[e("el-table-column",{attrs:{prop:"type",label:"类型",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.keycodeOptions.types[e.row.type]||"其他"))]}}],null,!1,1101775500)}),e("el-table-column",{attrs:{prop:"subtype",label:"渠道",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t.keycodeOptions.subtypes[e.row.subtype]||"其他"))]}}],null,!1,178056652)}),e("el-table-column",{attrs:{label:"面额",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.count))]}}],null,!1,1801049342)}),e("el-table-column",{attrs:{label:"卡密",width:"360"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"u-card"},[e("div",{staticClass:"u-count"},[e("div",{staticClass:"u-line"},[e("span",[t._v("卡号："+t._s(a.row.key||"****************"))]),a.row.key?e("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:""+a.row.key,expression:"'' + scope.row.key",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"u-btn",attrs:{type:"txt",size:"mini",icon:"el-icon-document-copy"}},[t._v("复制卡号")]):t._e()],1),e("div",{staticClass:"u-line"},[e("span",[t._v("卡密："+t._s(a.row.code||"****************")+" ")]),a.row.code?t._e():e("el-button",{attrs:{type:"primary",icon:"el-icon-view",size:"mini",plain:""},on:{click:function(e){return t.getKeycode(a.$index,a.row)}}},[t._v("点击查看")]),a.row.code?e("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:""+a.row.code,expression:"'' + scope.row.code",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"u-btn",attrs:{type:"txt",size:"mini",icon:"el-icon-document-copy"}},[t._v("复制卡密")]):t._e()],1)])])]}}],null,!1,1155304115)}),e("el-table-column",{attrs:{label:"过期时间",width:"200"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.expire_at?e("div",{staticClass:"u-time"},[e("span",{staticClass:"u-tag",class:t.compareTime(a.row.expire_at,"tag")},[t._v(t._s(t.compareTime(a.row.expire_at,"time")))]),e("span",[t._v(t._s(a.row.expire_at))])]):e("span",[t._v("-")])]}}],null,!1,3144732282)}),e("el-table-column",{attrs:{label:"发放时间",width:"200",prop:"grant_at"}}),e("el-table-column",{attrs:{prop:"remark",label:"备注",width:"200"}}),e("el-table-column",{attrs:{prop:"used_by_self",label:"是否使用"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{staticClass:"u-used",class:{"is-used":a.row.used_by_self}},[t._v(t._s(a.row.used_by_self?"是":"否"))]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:!a.row.used_by_self,expression:"!scope.row.used_by_self"}],attrs:{type:"text",size:"mini"},on:{click:function(e){return t.onKeyCodeUsedClick(a.row)}}},[t._v("（标记使用）")])]}}],null,!1,2362541912)})],1):e("el-alert",{staticClass:"m-credit-null m-packet-null",attrs:{title:"没有找到任何记录",type:"info",center:"","show-icon":""}}),t.showPagination?e("el-pagination",{staticClass:"m-credit-pages",attrs:{background:"","page-size":t.per,"hide-on-single-page":!0,"current-page":t.page,layout:"total, prev, pager, next, jumper",total:t.total},on:{"current-change":t.currentChange,"update:currentPage":function(e){t.page=e},"update:current-page":function(e){t.page=e}}}):t._e()],1)],1)],1)],1)},o=[function(){var t=this,e=t._self._c;return e("span",[e("i",{staticClass:"el-icon-bank-card"}),t._v(" 我的卡密 ")])}],s=a("5530"),r=(a("4de4"),a("d81d"),a("14d9"),a("fb6a"),a("b0c0"),a("e9f5"),a("910d"),a("ab43"),a("a9e3"),a("d3b7"),a("99af"),a("41cb"));function i(t){return Object(r["$pay"])().get("/api/my/codekeycode/history",{params:t})}function c(t){return Object(r["$pay"])().get("/api/my/codesn/history",{params:t})}function l(t,e){return Object(r["$pay"])().post("/api/my/codesn/".concat(t,"/activation-code"),e)}function u(t,e){return Object(r["$pay"])().post("/api/my/codekeycode/".concat(t,"/activation-code"),e)}function p(t,e){return Object(r["$pay"])().put("/api/my/codesn/".concat(t,"/mark/").concat(e))}function d(t,e){return Object(r["$pay"])().put("/api/my/codekeycode/".concat(t,"/mark/").concat(e))}function f(t,e){return Object(r["$pay"])().post("/api/mall/my/virtual_goods/".concat(t,"/secret"),e)}function b(t,e){return Object(r["$pay"])().put("/api/mall/my/virtual_goods/".concat(t,"/mark-used/").concat(e))}var m=a("244d"),y=a("c569"),g=a("86f6"),_=a("cc9a"),h=a("2ef0"),v={name:"card",data:function(){return{loading:!1,per:10,page:1,total:0,tab:"sn",list:[],keycodeOptions:y,snOptions:g,showPagination:!0,onlyNew:!1,virtualList:[],codeList:[],keycodeList:[],bread:""}},computed:{params:function(){return{tab:this.tab,pageIndex:this.page,pageSize:this.per}},loadName:function(){return"load"+this.tab.slice(0,1).toUpperCase()+this.tab.slice(1)},filteredList:function(){return this.onlyNew?this.list.filter((function(t){return!t.used_by_self})):this.list}},watch:{onlyNew:function(){"sn"==this.tab?(this.page=1,this.loadSn()):"keycode"==this.tab&&(this.page=1,this.loadKeycode())}},methods:{loadKeycode:function(){var t=this;this.loading=!0,this.$router.push({name:"card",query:{tab:"keycode",page:this.page}}),this.showPagination=!1;var e=Object(s["a"])(Object(s["a"])({},this.params),{},{used_by_self:this.onlyNew?0:void 0});i(e).then((function(e){var a=e.data.data.list||[];t.keycodeList=a.map((function(t){return t.code="",t})),t.total=e.data.data.page.total})).finally((function(){t.loading=!1,t.showPagination=!0}))},loadSn:function(){var t=this;this.loading=!0,this.$router.push({name:"card",query:{tab:"sn",page:this.page}}),this.showPagination=!1;var e=Object(s["a"])(Object(s["a"])({},this.params),{},{used_by_self:this.onlyNew?0:void 0});c(e).then((function(e){var a=e.data.data.list||[];t.codeList=a.map((function(t){return t.sn="",t.code="",t})),t.total=e.data.data.page.total})).finally((function(){t.loading=!1,t.showPagination=!0}))},loadVirtual:function(){var t=this;this.loading=!0,this.$router.push({name:"card",query:{tab:"virtual",page:this.page}}),this.showPagination=!1,Object(m["j"])({sub_category:"codesn",virtual_type:1}).then((function(e){var a=e.data.data.list||[];t.virtualList=a.map((function(t){return t.goods.goods_secret="",t})),t.total=e.data.data.page.total})).finally((function(){t.loading=!1,t.showPagination=!0}))},getKeycode:function(t,e){var a=this;this.$prompt("请输入密码","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"password"}).then((function(n){var o=n.value;u(e.id,{password:o}).then((function(n){var o=n.data.data,s=o.code,r=o.key;e.code=s,e.key=r,a.$set(a.list,t,e)}))}))},getSn:function(t,e){var a=this;this.$prompt("请输入密码","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"password"}).then((function(n){var o=n.value;l(e.id,{password:o}).then((function(n){e.code=n.data.data.sn,a.$set(a.list,t,e)}))}))},getVirtualCode:function(t,e){var a=this;this.$prompt("请输入密码","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"password"}).then((function(n){var o=n.value;f(e.goods.id,{password:o}).then((function(e){var n=e.data.data.good_number,o=Object(h["cloneDeep"])(a.virtualList);a.virtualList=o.map((function(e,a){return a===t&&(e.code=n),e}))}))}))},compareTime:function(t,e){var a=new Date(t).getTime()>Date.now()?0:1,n={0:"green",1:"gray"},o={0:"未过期",1:"已过期"};return"tag"==e?n[a]:o[a]},onKeyCodeUsedClick:function(t){var e=this;this.$confirm("确认标记为已使用吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){d(t.id,"used").then((function(t){e.$message({type:"success",message:"标记成功!"}),e.loadKeycode()}))})).catch((function(){}))},onSnUsedClick:function(t){var e=this;this.$confirm("确认标记为已使用吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){p(t.id,"used").then((function(t){e.$message({type:"success",message:"标记成功!"}),e.loadSn()}))})).catch((function(){}))},onVirtualUsedClick:function(t){var e=this;this.$confirm("确认标记为已使用吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){b(t.goods.id,1).then((function(t){e.$message({type:"success",message:"标记成功!"}),e.loadVirtual()}))})).catch((function(){}))},onCopy:function(t){this.$notify({title:"复制成功",message:"复制内容 : "+t.text,type:"success"})},onError:function(){this.$notify.error({title:"复制失败",message:"请手动复制"})},currentChange:function(t){this.page=t,this[this.loadName]()},tabClick:function(t){this.page=1,this.tab=t.name,this[this.loadName]()}},mounted:function(){var t=this;this.$route.query.tab&&(this.tab=this.$route.query.tab),this.page=Number(this.$route.query.page||1),this.loadName&&this[this.loadName](),Object(_["b"])("dashboard_card_tips").then((function(e){t.bread=e}))}},w=v,k=(a("7493"),a("2877")),x=Object(k["a"])(w,n,o,!1,null,null,null);e["default"]=x.exports},"557c":function(t,e,a){},7493:function(t,e,a){"use strict";a("557c")},"86f6":function(t){t.exports=JSON.parse('{"types":{"tf":"体服激活码","game":"游戏内激活码"},"subtypes":{"boxcoin":"盒币兑换","lottery":"积分抽奖","weibo":"微博活动","jdt":"赛事奖励"}}')},c569:function(t){t.exports=JSON.parse('{"types":{"seasun_ykt":"金山一卡通","other":"其它"},"subtypes":{"boxcoin":"盒币兑换","lottery":"积分抽奖","weibo":"微博活动","jdt":"赛事奖励"}}')}}]);