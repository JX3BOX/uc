(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-177a08bd"],{"01bb":function(t,e,i){},"0fe5":function(t,e,i){"use strict";i("bedc")},"29f2":function(t,e,i){"use strict";i("01bb")},"32ae":function(t,e,i){},"3c497":function(t,e,i){var n={"./icon_01.svg":"9997","./icon_02.svg":"9ceb"};function a(t){var e=o(t);return i(e)}function o(t){if(!i.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}a.keys=function(){return Object.keys(n)},a.resolve=o,t.exports=a,a.id="3c497"},"3dd4":function(t,e,i){},"498a":function(t,e,i){"use strict";var n=i("23e7"),a=i("58a8").trim,o=i("c8d2");n({target:"String",proto:!0,forced:o("trim")},{trim:function(){return a(this)}})},"4e44":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"m-mall-web"},[e("SearchBox"),e("GoodList",{attrs:{list:t.list,noData:t.noData}}),e("Nav")],1)},a=[],o=i("c14f"),s=i("2909"),c=i("1da1"),r=i("5530"),l=(i("99af"),i("d81d"),i("e9f5"),i("7d54"),i("ab43"),i("d3b7"),i("159b"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"search-bar"},[e("div",{staticClass:"select-box"},[e("i",{staticClass:"el-icon-s-unfold",staticStyle:{"font-size":"5.3333vw"},on:{click:function(e){return t.$store.commit("mallNew/toState",{navIsShow:!0})}}}),e("div",{staticClass:"select-item"},[e("el-select",{attrs:{value:t.c_level,placeholder:"等级限制"},on:{change:function(e){return t.handleChange(e,"level")}}},t._l(t.level_options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("div",{staticClass:"select-item"},[e("el-select",{attrs:{value:t.query.vip_limit,placeholder:"会员限制"},on:{change:function(e){return t.handleChange(e,"vip_limit")}}},t._l(t.member_options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),e("div",{staticClass:"search-input"},[e("el-input",{attrs:{value:t.query.title,placeholder:"搜索商品关键词"},on:{input:function(e){return t.handleChange(e,"title")}}},[e("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1)])}),u=[],d=(i("498a"),{name:"SearchBox",inject:["query","changeQuery"],data:function(){return{level:"",vip_limit:"",title:"",level_options:[{value:0,label:"全部"},{value:1,label:"lv.1"},{value:2,label:"lv.2"},{value:3,label:"lv.3"},{value:4,label:"lv.4"},{value:5,label:"lv.5"},{value:6,label:"lv.6"}],member_options:[{value:-1,label:"全部"},{value:1,label:"会员限制"},{value:0,label:"非会员限制"}]}},computed:{c_level:{get:function(){return null===this.query.level?"":0===this.query.level?"全部":"等级：lv."+this.query.level}}},methods:{handleChange:function(t,e){switch(e){case"level":this.changeQuery("level",t);break;case"vip_limit":this.changeQuery("vip_limit",t);break;case"title":this.changeQuery("title",t.trim());break}}}}),v=d,h=(i("6e7e"),i("2877")),g=Object(h["a"])(v,l,u,!1,null,"33eadd5e",null),f=g.exports,m=function(){var t=this,e=t._self._c;return e("div",{ref:"goodList",staticClass:"m-good-list"},[t._l(t.list,(function(t){return e("GoodItem",{key:t.id,attrs:{good:t}})})),t.noData?e("div",{staticClass:"u-no-data"},[t._v("~ ✿ 已经到底了哦 ✿ ~")]):t._e()],2)},p=[],y=i("2ef0"),b=(i("14d9"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"good-item",on:{click:function(e){return t.$router.push({name:"mall_detail_web",params:{id:t.good.id}})}}},[e("img",{staticClass:"good-item-img",attrs:{src:t.good.goods_images[0],alt:""}}),e("div",{staticClass:"right"},[e("div",{staticClass:"header"},[e("div",{staticClass:"title"},[t._v(t._s(t.good.title))]),t.good.subtitle?e("div",{staticStyle:{width:"100%",display:"flex"}},[e("div",{staticClass:"sub-title"},[t._v(t._s(t.good.subtitle))])]):t._e(),e("div",{staticClass:"tags"},[e("div",{staticClass:"tag"},[t._v("lv."+t._s(t.getLevel(t.good.exp_limit)))]),1===t.good.vip_limit?e("div",{staticClass:"tag"},[t._v("会员专享")]):t._e()])]),e("div",{staticClass:"footer"},[e("button",{class:{button:!0,canBuy:t.good.canBuy.canBuy},attrs:{disabled:!t.good.canBuy.canBuy},on:{click:function(e){return e.stopPropagation(),t.buyGoods(t.good)}}},[t.good.canBuy.canBuy?e("div",{staticClass:"button-text canBuy"},[t.good.price_boxcoin?[e("svg",{style:"fill: white; margin-right: 0.6vw; width: 3.2vw; height: 3.2vw",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"10.392",height:"12",viewBox:"0 0 10.392 12",fill:"rgba(64, 128, 255, 1)","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M10.392 3v6l-5.196 3L0 9V3l5.196-3 5.196 3zm-5.196-.69l3.196 1.845v3.69L5.196 9.691 2 7.845v-3.69l3.196-1.846z"}})]),t._v(t._s(t.good.price_boxcoin)+"盒币 ")]:t._e(),t.good.price_boxcoin&&t.good.price_points?[t._v(" + ")]:t._e(),t.good.price_points?[e("svg",{style:"fill: white; margin-right: 0.6vw; width: 3.2vw; height: 3.2vw",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"12",viewBox:"0 0 10 12",fill:"#7478ed","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[e("path",{attrs:{d:"M10 5A5 5 0 100 5v5h3a2 2 0 104 0h3V5zM8 8V5a3 3 0 00-6 0v3h6z","fill-rule":"evenodd"}})]),t._v(t._s(t.good.price_points)+"积分 ")]:t._e()],2):e("div",{staticClass:"button-text"},[t._v("不满足兑换条件")])]),t.good.canBuy.canBuy?e("div",{staticClass:"icon",on:{click:function(e){return e.stopPropagation(),t.addCart.apply(null,arguments)}}},[e("img",{attrs:{src:t.imgUrl+"cart.svg",alt:""}})]):t._e()])]),e("BuyConfirm",{ref:"buyConfirm",attrs:{item:t.good}})],1)}),_=[],w=(i("7db0"),i("f665"),i("c9d2")),k=i("d09f"),C=i("01ea"),x={name:"GoodItem",components:{BuyConfirm:k["a"]},data:function(){return{imgUrl:C["e"]+"design/mall/"}},props:{good:{type:Object,required:!0}},methods:{getLevel:function(t){return w["a"].getLevel(t)},buyGoods:Object(y["throttle"])((function(){this.$refs.buyConfirm.isShow=!0}),2e3),addCart:Object(y["throttle"])((function(t){var e,i,n=this,a=(null===(e=this.$store.state.mall.cart)||void 0===e||null===(i=e.find((function(t){return t.goods_id===n.good.id})))||void 0===i?void 0:i.amount)||0;if(1+a>this.good.stock)return this.$message({type:"warning",message:"可兑换库存不足"});this.$store.dispatch("mallNew/addCart",{id:this.good.id,amount:1}).then((function(e){e&&n.fly(t)}))}),1e3),fly:function(t){var e="IMG"===t.target.tagName?t.target.parentElement:t.target,i=e.parentElement,n=e.getBoundingClientRect(),a=n.left,o=n.top,s=this.$store.state.mallNew.boundCart,c=s.left,r=s.top,l=e.cloneNode(!0);l.style.cssText="\n                position: fixed;\n                left: ".concat(a,"px;\n                top: ").concat(o,"px;\n                z-index: 1000;\n            "),i.appendChild(l),l.animate([{transform:"translate(".concat(c-a,"px, ").concat(r-o,"px)")}],{duration:500,easing:"ease-in-out",fill:"forwards"}),setTimeout((function(){i.removeChild(l)}),500)}}},B=x,L=(i("559c"),Object(h["a"])(B,b,_,!1,null,"38dc4d69",null)),j=L.exports,O={name:"GoodList",components:{GoodItem:j},inject:["changeQuery","query","hasMore"],props:{list:{type:Array,default:function(){return[]}},noData:{type:Boolean,default:!1}},watch:{"query.pageIndex":function(t){1===t&&(this.$refs.goodList.scrollTop=0)}},methods:{handleScroll:Object(y["debounce"])((function(){var t=this.$refs.goodList;this.hasMore&&t.scrollTop+t.clientHeight>=t.scrollHeight-200&&this.changeQuery("pageIndex",this.query.pageIndex+1,!0)}),500)},mounted:function(){this.$refs.goodList.addEventListener("scroll",this.handleScroll)},beforeDestroy:function(){this.$refs.goodList.removeEventListener("scroll",this.handleScroll)}},q=O,S=(i("0fe5"),Object(h["a"])(q,m,p,!1,null,"77862d65",null)),I=S.exports,$=i("015f"),D=(i("b0c0"),i("9911"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-mall-types",class:{isShow:t.$store.state.mallNew.navIsShow}},[e("div",{staticClass:"close-icon",on:{click:function(e){return t.$store.commit("mallNew/toState",{navIsShow:!1})}}},[e("i",{staticClass:"el-icon-s-fold"})]),t._l(t.types,(function(n,a){return e("div",{key:a,staticClass:"u-item"},["system"!=n.key?e("div",{class:{"u-title":!0,active:t.query.category==n.key},on:{click:function(e){return t.itemLinkClick(n.key)}}},[e("i",{staticClass:"u-icon",class:n.icon}),t._v(" "+t._s(n.name)+" ")]):e("span",{staticClass:"u-title",class:t.query.category==n.key?"active":"",staticStyle:{cursor:"default"}},[e("i",{staticClass:"u-icon",class:n.icon}),t._v(" "+t._s(n.name))]),"system"!=n.key?e("div",{staticClass:"u-children-list"},t._l(n.sub_category,(function(a,o){return e("div",{key:o,class:{"u-child":!0,active:t.query.sub_category==a.key},on:{click:function(e){return t.childLinkClick(n.key,a.key)}}},[e("img",{attrs:{"svg-inline":"",src:i("3c497")("./icon_0".concat(t.query.sub_category!==a.key?"1":"2",".svg"))}}),t._v(" "+t._s(a.name)+" ")])})),0):e("div",{staticClass:"u-children-list"},t._l(n.sub_category,(function(n,a){return e("a",{key:a,staticClass:"u-child",class:t.query.sub_category==n.key||t.query.sub_category==n.key?"active":"",attrs:{href:n.link,target:n.target}},[e("img",{attrs:{"svg-inline":"",src:i("3c497")("./icon_0".concat(t.query.sub_category!==n.key?"1":"2",".svg"))}}),t._v(" "+t._s(n.name)+" ")])})),0)])}))],2)}),N=[],z=i("6622"),Q={name:"Nav",data:function(){return{types:z}},inject:["query","changeQuery"],methods:{itemLinkClick:function(t){this.changeQuery(["category","sub_category"],[t,""])},childLinkClick:function(t,e){this.changeQuery(["category","sub_category"],[t,e])},handleCurrentChange:function(t){this.changeQuery("pageIndex",t,!0)}}},G=Q,E=(i("913c"),Object(h["a"])(G,D,N,!1,null,"611bd8f9",null)),M=E.exports,T=i("53ca");i("b64b");function P(t){return Object(y["pickBy"])(t,(function(t){return null!==t&&void 0!==t&&(("string"!==typeof t||""!==t.trim())&&((!Array.isArray(t)||0!==t.length)&&("object"!==Object(T["a"])(t)||null===t||0!==Object.keys(t).length)))}))}var A={name:"Index",data:function(){return{query:{pageSize:10,pageIndex:1,level:null,vip_limit:null,title:"",category:"",sub_category:""},goodsList:[],hasMore:!0,isLoading:!1,noData:!1}},components:{SearchBox:f,GoodList:I,Nav:M},provide:function(){return{query:this.query,changeQuery:this.changeQuery,hasMore:this.hasMore,isLoading:this.isLoading,noData:this.noData}},computed:{asset:function(){return this.$store.state.mallNew.asset},list:function(){var t,e=this;return null===(t=this.goodsList)||void 0===t?void 0:t.map((function(t){return Object(r["a"])(Object(r["a"])({},t),{},{canBuy:e.checkCanBuy(t)})}))}},methods:{loadData:function(){var t=this;return Object(c["a"])(Object(o["a"])().m((function e(){var i,n,a,c,r,l,u;return Object(o["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:if(e.p=0,1===t.query.pageIndex&&(t.noData=!1),!t.noData){e.n=1;break}return e.a(2);case 1:return t.isLoading=!0,e.n=2,Object($["e"])(P(t.query));case 2:a=e.v,c=(null===(i=a.data.data)||void 0===i?void 0:i.list)||[],r=[].concat(Object(s["a"])(t.goodsList),Object(s["a"])(c)),t.goodsList=1==t.query.pageIndex?c:Object(y["unionBy"])(r,"id"),l=null===(n=a.data.data)||void 0===n?void 0:n.page.pageTotal,t.hasMore=t.query.pageIndex<l,c.length||(t.noData=!0),e.n=4;break;case 3:e.p=3,u=e.v,console.error("加载数据失败",u);case 4:return e.p=4,t.isLoading=!1,e.f(4);case 5:return e.a(2)}}),e,null,[[0,3,4,5]])})))()},changeQuery:function(t,e,i){var n=this;Array.isArray(t)?t.forEach((function(t,i){n.query[t]=e[i]})):this.query[t]=e,i||(this.query.pageIndex=1),this.loadData()},checkCanBuy:function(t){var e={canBuy:!0,vip_limit:!0,box_coin:!0,points:!0,level:!0,user_level:w["a"].getLevel(t.exp_limit),buy_time:!0};return 1!==t.vip_limit||w["a"]._isPRO(this.asset)||(e.canBuy=!1,e.vip_limit=!1),this.asset.box_coin<t.price_boxcoin&&(e.canBuy=!1,e.box_coin=!1),this.asset.points<t.price_points&&(e.canBuy=!1,e.points=!1),this.asset.experience<t.exp_limit&&(e.canBuy=!1,e.level=!1),0===t.on_selling&&(e.canBuy=!1,e.buy_time=!1),e},getBoundCart:Object(y["debounce"])((function(){var t=document.getElementById("cartBtn").getBoundingClientRect(),e=t.left,i=t.top;this.$store.dispatch("mallNew/setBoundCart",{left:e,top:i})}),500)},created:function(){this.loadData()},mounted:function(){this.getBoundCart(),window.addEventListener("resize",this.getBoundCart)},beforeDestroy:function(){window.removeEventListener("resize",this.getBoundCart)}},R=A,U=(i("bb7b"),Object(h["a"])(R,n,a,!1,null,"69f6a8f8",null));e["default"]=U.exports},"559c":function(t,e,i){"use strict";i("3dd4")},6622:function(t){t.exports=JSON.parse('[{"name":"全部","key":"","icon":"el-icon-menu"},{"name":"实物","key":"entity","icon":"el-icon-s-goods","sub_category":[{"name":"定制纪念品","key":"jdt"},{"name":"其它","key":"other"}]},{"name":"虚拟","key":"virtual","icon":"el-icon-s-ticket","sub_category":[{"name":"主题装扮","key":"skin"},{"name":"魔卡","key":"palu"},{"name":"头像框","key":"avatar"},{"name":"表情包","key":"emotion"}]},{"name":"系统","key":"system","icon":"el-icon-s-finance","sub_category":[{"name":"专业版","key":"vip","link":"/vip/premium","target":"_blank"},{"name":"改名卡","key":"rename2","link":"/vip/rename","target":"_blank"},{"name":"铭牌","key":"namespace2","link":"/vip/namespace","target":"_blank"},{"name":"点月卡","key":"dianyueka","link":"https://charge.xoyo.com/pay?item=jx3&__from=jx3box","target":"_blank"}]}]')},"6e7e":function(t,e,i){"use strict";i("32ae")},"913c":function(t,e,i){"use strict";i("ac8e")},9997:function(t,e,i){t.exports=i.p+"img/icon_01.00399bff.svg"},"9ceb":function(t,e,i){t.exports=i.p+"img/icon_02.d9bfe3db.svg"},a5fa:function(t,e,i){},ac8e:function(t,e,i){},bb7b:function(t,e,i){"use strict";i("a5fa")},bedc:function(t,e,i){},c8d2:function(t,e,i){"use strict";var n=i("5e77").PROPER,a=i("d039"),o=i("5899"),s="​᠎";t.exports=function(t){return a((function(){return!!o[t]()||s[t]()!==s||n&&o[t].name!==t}))}},d09f:function(t,e,i){"use strict";var n=function(){var t,e,i=this,n=i._self._c;return n("el-dialog",{attrs:{visible:i.isShow,width:"85%","show-close":!1,"custom-class":"m-buy-confirm"},on:{"update:visible":function(t){i.isShow=t}}},[n("div",{staticClass:"content"},[n("img",{staticStyle:{width:"32vw",height:"32vw"},attrs:{src:null!==(t=i.item)&&void 0!==t&&null!==(e=t.goods_images)&&void 0!==e&&e[0]?i.item.goods_images[0]:"@/assets/img/publish/logo.svg"}}),n("div",{staticClass:"text"},[i._v(" 确认使用"),n("span",{staticClass:"price"},[i._v(i._s(i.confirmText))]),i._v("兑换"),n("span",{staticClass:"title"},[i._v(i._s(i.item.title))]),i._v("嘛？ ")])]),n("div",{staticClass:"btn-box"},[n("el-button",{staticStyle:{width:"20.5333vw","font-size":"3.2vw"},attrs:{round:"",size:"mini"},on:{click:function(t){t.stopPropagation(),i.isShow=!1}}},[i._v("取消")]),n("el-button",{staticStyle:{width:"20.5333vw","font-size":"3.2vw"},attrs:{type:"primary",round:"",size:"mini"},on:{click:function(t){return t.stopPropagation(),i.buyGoods.apply(null,arguments)}}},[i._v("确定")])],1)])},a=[],o=(i("99af"),i("14d9"),i("c9d2")),s=i("01ea"),c={name:"BuyConfirm",props:{item:{type:Object,default:function(){}}},data:function(){return{isShow:!1}},computed:{confirmText:function(){return this.item.price_points&&this.item.price_boxcoin?"".concat(this.item.price_boxcoin,"盒币和").concat(this.item.price_points,"积分"):this.item.price_points?"".concat(this.item.price_points,"积分"):this.item.price_boxcoin?"".concat(this.item.price_boxcoin,"盒币"):""}},methods:{buyGoods:function(){var t=this;if(!o["a"].isLogin())return this.$message.error("请先登录"),void setTimeout((function(){o["a"].toLogin()}),1e3);this.isShow=!1;var e=this.item,i=e.category,n=e.is_virtual,a=e.id;if(n&&"virtual"==i)return this.$store.dispatch("mallNew/buyGoods",{id:a,count:1,addressId:0,remark:"虚拟商品购买"}).then((function(e){t.$confirm("购买成功，是否跳转至订单界面?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t="".concat(s["c"],"dashboard/mall");window.open(t)})).catch((function(){}))}));this.$router.push({name:"mall_order_new",params:{id:a}})}}},r=c,l=(i("29f2"),i("2877")),u=Object(l["a"])(r,n,a,!1,null,"cd81a4c6",null);e["a"]=u.exports}}]);