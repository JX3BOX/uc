(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-50a228eb"],{"01ad":function(t,e,i){"use strict";i.r(e);i("ac1f"),i("841c"),i("498a");var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-mall-box"},[e("div",{staticClass:"m-mall-search"},[e("div",{staticClass:"m-search"},[e("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入搜索内容",clearable:""},model:{value:t.search,callback:function(e){t.search="string"===typeof e?e.trim():e},expression:"search"}},[e("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("关键词")]),e("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),e("div",{staticClass:"m-filter"},[e("div",{staticClass:"m-filter-level"},[e("span",{staticClass:"u-label"},[t._v("等级")]),e("el-select",{attrs:{placeholder:"请选择等级"},on:{change:function(e){return t.changeMeta("level")}},model:{value:t.level,callback:function(e){t.level=e},expression:"level"}},t._l(t.levelOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("div",{staticClass:"m-filter-level"},[e("span",{staticClass:"u-label"},[t._v("VIP限制")]),e("el-select",{attrs:{placeholder:"请选择"},on:{change:function(e){return t.changeMeta("vip_limit")}},model:{value:t.vip_limit,callback:function(e){t.vip_limit=e},expression:"vip_limit"}},t._l(t.vipOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)])]),t.list&&t.list.length?e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-mall-list"},t._l(t.list,(function(i){return e("Item",{key:i.id,attrs:{isPro:t.isPro,data:i,skinJson:t.skinJson,myVirtualItems:t.myVirtualItems}})})),1):e("div",{staticClass:"m-mall-null"},[e("el-empty",{attrs:{description:"当前条件下没有找的符合的记录"}})],1),e("el-pagination",{staticClass:"m-mall-pages m-archive-pages",attrs:{background:"","hide-on-single-page":!0,"current-page":t.pageIndex,"page-size":t.pageSize,layout:"total, prev, pager, next",total:t.total},on:{"current-change":t.changePage,"update:currentPage":function(e){t.pageIndex=e},"update:current-page":function(e){t.pageIndex=e}}})],1)},s=[],n=i("ade3"),r=(i("caad"),i("14d9"),i("a9e3"),i("b64b"),i("d3b7"),i("2532"),i("015f")),l=function(){var t,e=this,i=e._self._c;return e.item?i("router-link",{class:{"m-mall-item":!0,"m-show-back-item":e.allowShowBackground(e.item)},style:{"--title-color":e.skin.titleColor,"--title-hover-color":e.skin.titleHoverColor,"--border-hover-color":e.skin.borderHoverColor,"--skin-background":e.skin.background?"url(".concat(e.skin.background,")"):"none"},attrs:{to:{name:"mall_detail",params:{id:e.item.id}},target:"_blank"}},[i("div",{staticClass:"u-img",class:{isAvatar:e.isAvatar}},[i("img",{staticClass:"u-frame",attrs:{src:e.showCover(e.item),fit:"contain"}}),i("span",{staticClass:"u-avatar c-avatar"},[i("img",{staticClass:"c-avatar-pic",attrs:{src:e.showAvatarImg(e.avatar)}}),e.frameUrl?i("i",{staticClass:"c-avatar-frame"},[i("img",{attrs:{src:e.frameUrl}})]):e._e()])]),i("div",{staticClass:"u-content"},[i("span",{staticClass:"u-title"},[e.item.is_only_lottery?i("span",{staticClass:"u-label"},[i("i",{staticClass:"el-icon-present"}),e._v("抽奖限定")]):e._e(),e._v(" "+e._s(e.item.title)+" ")]),i("div",{staticClass:"u-desc"},[i("span",{staticClass:"u-subtitle"},[e.item.subtitle?i("span",[e._v(e._s(e.item.subtitle))]):e._e()]),i("span",{staticClass:"u-count"},[e._v("库存："),i("b",[e._v(e._s(e.item.stock))])])]),i("div",{staticClass:"u-exchange"},[i("el-divider",{attrs:{"content-position":"left"}},[i("i",{staticClass:"el-icon-sunny"}),e._v(" 兑换需求")]),i("span",[e._v("等级： Lv."+e._s(e.showLevel(e.item.exp_limit)))]),i("span",{directives:[{name:"show",rawName:"v-show",value:e.item.vip_limit,expression:"item.vip_limit"}]},[e._v("仅会员")]),i("span",{directives:[{name:"show",rawName:"v-show",value:e.item.price_points,expression:"item.price_points"}]},[e._v("积分： "+e._s(e.item.price_points))]),i("span",{directives:[{name:"show",rawName:"v-show",value:e.item.price_boxcoin,expression:"item.price_boxcoin"}]},[e._v("盒币： "+e._s(e.item.price_boxcoin))]),i("span",{directives:[{name:"show",rawName:"v-show",value:e.item.price_cny,expression:"item.price_cny"}]},[e._v("金箔： "+e._s(e.item.price_cny))])],1)]),e.item.taobao_link||e.isVerify||e.isTimeout?e._e():i("div",{staticClass:"u-op"},[e.isHad?i("span",{staticClass:"is-had"},[i("el-button",{attrs:{disabled:"",icon:"el-icon-shopping-cart-1",circle:"",size:"small"}})],1):[i("el-button",{attrs:{disabled:!e.isLogin||!e.item.stock,icon:"el-icon-shopping-cart-1",circle:"",id:"btnCart_".concat(e.item.id),size:"small"},on:{click:function(t){return t.preventDefault(),e.handleAddCart.apply(null,arguments)}}}),i("div",{staticClass:"c-fly-item",attrs:{id:"flyItem_".concat(e.item.id)}},[i("img",{attrs:{src:e.showAvatar(null===(t=e.item.goods_images)||void 0===t?void 0:t[0])}})])]],2)]):e._e()},o=[],c=(i("99af"),i("7db0"),i("e9f5"),i("f665"),i("85e4")),u=i("65c2"),d=i("2ef0"),m=i("c9d2"),v=(i("5482"),{name:"GoodsIndexItem",props:["data","isPro","myVirtualItems","skinJson"],data:function(){return{item:{},skinPartMap:{"侧边栏":"sidebar","名片":"atcard","评论":"comment","日历":"calendar","主页":"homebanner"}}},watch:{data:{immediate:!0,handler:function(t){this.item=t}}},computed:{isLogin:function(){return m["a"].isLogin()},skin:function(){var t=this.skinJson,e=this.item,i=e.remark;if("palu"==e.sub_category&&i){if(t[i])return{background:this.getSkinBackgroundUrl(e),titleColor:t[i].titleColor,titleHoverColor:t[i].titleHoverColor,borderHoverColor:t[i].borderHoverColor}}else if("skin"==e.sub_category)return{background:this.getSkinBackgroundUrl(e),titleColor:"#0366d6",titleHoverColor:"rgba(255, 64, 128, 1)",borderHoverColor:"#0366d6"};return{titleColor:"#0366d6",titleHoverColor:"rgba(255, 64, 128, 1)",borderHoverColor:"#0366d6"}},uid:function(){var t=localStorage.getItem("uid");return t||0},isAvatar:function(){return"avatar"===this.item.sub_category},avatar:function(){var t=localStorage.getItem("avatar")||"";return t?this.resolveImagePath(t):this.showCover(this.item)},frameUrl:function(){var t=u["__imgPath"]+"avatar/images/".concat(this.item.remark,"/").concat(this.item.remark,".svg");return this.isAvatar&&this.item.remark?t:""},asset:function(){return this.$store.state.mall.asset||{}},isVerify:function(){var t=this.asset,e=t.experience,i=t.cny,a=t.points,s=t.box_coin,n=this.item,r=n.exp_limit,l=n.price_cny,o=n.price_points,c=n.price_boxcoin,u=n.vip_limit;return this.showDetailLevel(e)<this.showDetailLevel(r)||(i<l||(a<o||(s<c||!(!u||this.isPro))))},isTimeout:function(){var t=this.item,e=t.start_sell_time,i=t.end_sell_time;return!(!e||!this.isExpire(e))||!(!i||this.isExpire(i))},isHad:function(){var t=this.data;return!!this.myVirtualItems.find((function(e){return"virtual"===t.category&&1===t.vip_limit&&e.type===t.sub_category&&e.val===t.remark}))}},methods:{fly:function(){var t=document.getElementById("btnCart_".concat(this.item.id)),e=document.getElementById("flyItem_".concat(this.item.id)),i=e.querySelector("img"),a=40,s=!1,n=t.getBoundingClientRect(),r=this.$store.state.mall.boundCart,l=r.left+r.width/2-(n.left+n.width/2),o=r.top+r.height/2-(n.top+n.height/2);0==s&&(e.style.visibility="visible",e.style.left=n.left+a/2+"px",e.style.top=n.top+a/2+"px",e.style.transform="translateX("+l+"px)",i.style.transform="translateY("+o+"px)",s=!0,setTimeout((function(){e.style.visibility="hidden",e.style.transform="translateX(0)",i.style.transform="translateY(0)",s=!1}),490))},handleAddCart:function(){if(!m["a"].isLogin())return this.$message.error("请先登录"),void setTimeout((function(){m["a"].toLogin()}),1e3);this.item.stock&&this.addCart()},addCart:Object(d["throttle"])((function(){var t,e,i=this,a=(null===(t=this.$store.state.mall.cart)||void 0===t||null===(e=t.find((function(t){return t.goods_id===i.item.id})))||void 0===e?void 0:e.amount)||0;if(1+a>this.item.stock)return this.$message({type:"warning",message:"可兑换库存不足"});this.$store.dispatch("mall/addCart",{id:this.item.id,amount:1}).then((function(t){t&&i.fly()}))}),1e3),allowShowBackground:function(t){return"palu"===t.sub_category||"skin"===t.sub_category},getSkinBackgroundUrl:function(t){switch(t.sub_category){case"palu":return u["__cdn"]+"design/decoration/".concat(t.sub_category,"/").concat(t.remark,".png");case"skin":for(var e in this.skinPartMap)if(t.title.includes(e))return u["__cdn"]+"design/decoration/images/".concat(t.remark,"/").concat(this.skinPartMap[e],".png");return"none";default:return"none"}},resolveImagePath:c["resolveImagePath"],showAvatarImg:function(t){return Object(c["showAvatar"])(t,360)},showAvatar:c["showAvatar"],showLevel:function(t){var e=1;return Object(d["forEach"])(u["__userLevel"],(function(i,a){t>=i[0]&&t<i[1]&&(e=a)})),e},showCover:function(t){var e=null===t||void 0===t?void 0:t.goods_images[0];return Object(c["getThumbnail"])(e,360)},showDetailLevel:function(t){return m["a"].getLevel(t)},isExpire:function(t){return Date.parse(new Date)<Date.parse(new Date(t))}}}),h=v,p=(i("3089"),i("2877")),g=Object(p["a"])(h,l,o,!1,null,null,null),f=g.exports,b={name:"MallList",data:function(){return{loading:!1,list:[],pageIndex:1,pageSize:9,total:0,number_queries:["pageSize","pageIndex"],search:"",title:"",category:"",sub_category:"",level:"0",vip_limit:"-1",levelOptions:[{label:"全部",value:"0"},{label:"Lv1",value:"1"},{label:"Lv2",value:"2"},{label:"Lv3",value:"3"},{label:"Lv4",value:"4"},{label:"Lv5",value:"5"},{label:"Lv6",value:"6"}],vipOptions:[{label:"全部",value:"-1"},{label:"会员限定",value:"1"},{label:"非会员限定",value:"0"}],isPro:!1,myVirtualItems:[]}},computed:{query:function(){return{category:this.category,sub_category:this.sub_category,title:this.title?this.title:this.search,level:this.level,vip_limit:this.vip_limit}},cartNum:function(){return this.$store.getters["mall/cartNum"]},isLogin:function(){return m["a"].isLogin()}},watch:{"$route.query":{deep:!0,immediate:!0,handler:function(t){if(this.title="",Object.keys(t).length)for(var e in t)this.number_queries.includes(e)?this[e]=Number(t[e]):"search"===e?this.title=t[e]:this[e]=t[e]}},query:{immediate:!0,deep:!0,handler:Object(d["debounce"])((function(){this.pageIndex=1,this.loadData()}),500)}},mounted:function(){var t=this;this.isLogin&&(this.$store.dispatch("mall/getAsset"),m["a"].isPRO().then((function(e){t.isPro=e})),this.loadDecoration()),this.loadSkinJson()},methods:{loadDecoration:function(){var t=this;Object(r["f"])().then((function(e){var i=e.data.data;t.myVirtualItems=i}))},loadSkinJson:function(){var t=this;Object(r["k"])().then((function(e){t.skinJson=e.data}))},openCart:function(){this.isLogin&&this.$store.commit("mall/SET_STATE",{key:"cartVisible",value:!0})},buildQuery:function(){var t={pageSize:this.pageSize,pageIndex:this.pageIndex};for(var e in this.query){var i,a;if(void 0!==this.query[e]&&""!==this.query[e]&&null!==this.query[e])if("level"===e&&0!=this.query.level)t.exp_limit=null===(i=u["__userLevel"][this.query.level])||void 0===i?void 0:i[0],t.exp_limit_max=(null===(a=u["__userLevel"][this.level])||void 0===a?void 0:a[1])-1||"";else t[e]=this.query[e].trim()}return t},loadData:function(){var t=this,e=this.buildQuery();this.loading=!0,Object(r["i"])(e).then((function(e){t.list=e.data.data.list,t.total=e.data.data.page.total})).finally((function(){t.loading=!1}))},changePage:function(t){this.loadData(),this.replaceRoute({pageIndex:t})},changeMeta:function(t){this.replaceRoute(Object(n["a"])(Object(n["a"])({},t,null===this||void 0===this?void 0:this[t]),"pageIndex",1))},replaceRoute:function(t){return this.$router.push({query:Object.assign({},this.$route.query,t)}).then((function(){window.scrollTo(0,0)})).catch((function(){}))}},components:{Item:f}},_=b,y=(i("2b4b"),Object(p["a"])(_,a,s,!1,null,null,null));e["default"]=y.exports},"0e6c":function(t,e,i){},"2b4b":function(t,e,i){"use strict";i("0e6c")},3089:function(t,e,i){"use strict";i("c8c6")},"498a":function(t,e,i){"use strict";var a=i("23e7"),s=i("58a8").trim,n=i("c8d2");a({target:"String",proto:!0,forced:n("trim")},{trim:function(){return s(this)}})},c8c6:function(t,e,i){},c8d2:function(t,e,i){"use strict";var a=i("5e77").PROPER,s=i("d039"),n=i("5899"),r="​᠎";t.exports=function(t){return s((function(){return!!n[t]()||r[t]()!==r||a&&n[t].name!==t}))}}}]);