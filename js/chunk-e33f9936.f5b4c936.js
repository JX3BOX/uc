(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e33f9936"],{"624f":function(t,n,e){t.exports=e.p+"img/repo.e8c2e45e.svg"},"8b87":function(t,n,e){"use strict";e.r(n);e("ac1f"),e("841c");var a=function(){var t=this,n=t._self._c;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-dashboard-work m-dashboard-cms p-cms-community"},[n("div",{staticClass:"m-dashboard-work-header"},[n("h2",{staticClass:"u-title"},[t._v("论坛")]),n("a",{staticClass:"u-publish el-button el-button--primary el-button--small",attrs:{href:t.publishLink}},[n("i",{staticClass:"el-icon-document"}),t._v(" 发布作品 ")])]),n("el-tabs",{model:{value:t.activeTab,callback:function(n){t.activeTab=n},expression:"activeTab"}},[n("el-tab-pane",{attrs:{label:"主题",name:"topic"}}),n("el-tab-pane",{attrs:{label:"回帖",name:"reply"}})],1),n("el-input",{staticClass:"m-dashboard-work-search",attrs:{placeholder:"请输入搜索内容"},model:{value:t.search,callback:function(n){t.search=n},expression:"search"}},[n("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("关键词")]),n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1),"topic"==t.activeTab?n("div",{staticClass:"m-dashboard-work-filter"}):t._e(),n("div",{staticClass:"m-dashboard-box"},[t.data&&t.data.length?n("ul",{staticClass:"m-dashboard-box-list"},t._l(t.data,(function(e,a){return n("li",{key:a},[t._m(0,!0),n("a",{staticClass:"u-title",attrs:{target:"_blank",href:t.postLink(e)}},["topic"==t.activeTab?n("span",[t._v(t._s(e.title||e.content||"无标题"))]):n("span",{staticClass:"u-title_content",domProps:{innerHTML:t._s(t.getContent(e))}})]),n("div",{staticClass:"u-desc"},[n("span",{staticClass:"u-desc-subitem"},[n("i",{staticClass:"el-icon-view"}),t._v(" "+t._s(t._f("visibleFormat")(e.is_self_visit||e.visible))+" ")]),n("time",{staticClass:"u-desc-subitem"},[n("i",{staticClass:"el-icon-finished"}),t._v(" 发布 : "+t._s(t._f("dateFormat")(e.created_at))+" ")]),n("time",{staticClass:"u-desc-subitem"},[n("i",{staticClass:"el-icon-refresh"}),t._v(" 更新 : "+t._s(t._f("dateFormat")(e.updated_at))+" ")]),n("time",{staticClass:"u-desc-subitem"},[n("i",{staticClass:"el-icon-receiving"}),t._v(" 状态 : "+t._s(t.getStatusCn(e.status))+" ")])]),n("el-button-group",{staticClass:"u-action"},[n("el-button",{attrs:{size:"mini",icon:"el-icon-edit",title:"编辑"},on:{click:function(n){return t.edit(e)}}}),n("el-button",{attrs:{size:"mini",icon:"el-icon-delete",title:"删除"},on:{click:function(n){return t.del(e)}}})],1)],1)})),0):n("el-alert",{staticClass:"m-dashboard-box-null",attrs:{title:"没有找到相关条目",type:"info",center:"","show-icon":""}}),n("el-pagination",{staticClass:"m-dashboard-box-pages",attrs:{background:"","page-size":t.per,"hide-on-single-page":!0,"current-page":t.page,layout:"total, prev, pager, next, jumper",total:t.total},on:{"update:currentPage":function(n){t.page=n},"update:current-page":function(n){t.page=n}}})],1)],1)},i=[function(){var t=this,n=t._self._c;return n("i",{staticClass:"u-icon"},[n("img",{attrs:{src:e("624f")}})])}],c=(e("99af"),e("caad"),e("fb6a"),e("d3b7"),e("2532"),e("a8b8")),s=e("fb92"),o=e("fa01"),u=e("2ef0"),r=e("65c2"),l={name:"work",props:[],data:function(){return{loading:!1,data:[],total:1,page:1,per:10,content:"",client:"",search:"",statusMap:o,activeTab:"topic"}},computed:{type:function(){return this.$route.params.type},params:function(){return{type:this.type,title:this.search||void 0,pageSize:this.per,index:this.page}},publishLink:function(){return"/publish/#/community"},showWujie:function(){return["bps","pvp","bbs"].includes(this.type)}},watch:{type:{deep:!0,immediate:!0,handler:function(t){this.page=1}},params:{deep:!0,immediate:!0,handler:function(t){this.loadPosts()}},activeTab:{handler:function(){this.page=1,this.loadPosts()}}},methods:{getStatusCn:function(t){switch(t){case 1:return"正常";case 2:return"待审核";case 3:return"审核未通过";default:return"未知状态"}},loadPosts:function(){var t=this;if(this.loading=!0,this.data=[],"topic"==this.activeTab)Object(c["f"])(this.params).then((function(n){t.data=n.data.data.list,t.total=n.data.data.page.total})).finally((function(){t.loading=!1}));else{var n=Object(u["pick"])(this.params,["pageSize","index"]);this.search&&(n.content=this.search),Object(c["h"])(n).then((function(n){t.data=n.data.data.list,t.total=n.data.data.page.total})).finally((function(){t.loading=!1}))}},edit:function(t){var n="topic"==this.activeTab?"community":"community_reply",e=this.$router.resolve({name:n,params:{id:t.id}});window.open(e.href,"_blank")},del:function(t){var n=this;this.$alert("确定要删除吗？","确认信息",{confirmButtonText:"确定",callback:function(e){if("confirm"==e){var a="topic"==n.activeTab?c["a"]:c["c"];a(t.id).then((function(){n.$message({type:"success",message:"删除成功"}),n.page=1,n.loadPosts()}))}}})},draft:function(t,n){var e=this;push(t,{publish_status:"draft"}).then((function(t){e.$message({type:"success",message:"操作成功"}),e.data[n].post_status="draft"}))},publish:function(t,n){var e=this;push(t,{publish_status:"publish"}).then((function(t){e.$message({type:"success",message:"操作成功"}),e.data[n].post_status="publish"}))},postLink:function(t){return"topic"==this.activeTab?"/community/".concat(t.id):"/community/".concat(t.topic_id)},filter:function(t){this.page=1,this[t.type]=t.val},isSimpleType:function(t){return simpleTypes.includes(t)},getContent:function(t){var n,e=t.content;return e?"#".concat(t.floor," 回复：").concat(null===t||void 0===t||null===(n=t.topic)||void 0===n?void 0:n.title)+e.slice(0,12)+"...":""}},filters:{dateFormat:function(t){return Object(s["a"])(new Date(t))},visibleFormat:function(t){return r["__visibleMap"][~~t]},statusFormat:function(t){return o[t]}}},d=l,p=(e("c680"),e("2877")),m=Object(p["a"])(d,a,i,!1,null,null,null);n["default"]=m.exports},a8b8:function(t,n,e){"use strict";e.d(n,"l",(function(){return c})),e.d(n,"f",(function(){return u})),e.d(n,"d",(function(){return p})),e.d(n,"a",(function(){return r})),e.d(n,"j",(function(){return l})),e.d(n,"m",(function(){return s})),e.d(n,"h",(function(){return m})),e.d(n,"g",(function(){return f})),e.d(n,"c",(function(){return b})),e.d(n,"o",(function(){return h})),e.d(n,"e",(function(){return g})),e.d(n,"b",(function(){return v})),e.d(n,"k",(function(){return d})),e.d(n,"n",(function(){return o})),e.d(n,"i",(function(){return y}));e("99af");var a=e("41cb"),i="/api/next2";function c(t){return Object(a["$next"])().post("".concat(i,"/community/discussion/topic"),t)}function s(t,n){return Object(a["$next"])().put("".concat(i,"/community/discussion/my/topic/item/").concat(t),n)}function o(t,n){return Object(a["$next"])().put("".concat(i,"/community/discussion/manage/topic/item/").concat(t,"/update"),n)}function u(t){return Object(a["$next"])().get("".concat(i,"/community/discussion/my/topic/list"),{params:t})}function r(t){return Object(a["$next"])().delete("".concat(i,"/community/discussion/my/topic/item/").concat(t))}function l(t){return Object(a["$next"])().get("".concat(i,"/community/discussion/my/topic/item/").concat(t))}function d(t){return Object(a["$next"])().get("".concat(i,"/community/discussion/manage/topic/item/").concat(t))}function p(t){return Object(a["$next"])().get("".concat(i,"/community/discussion/topic/list"),{params:t})}function m(t){return Object(a["$next"])().get("".concat(i,"/community/discussion/my/reply/list"),{params:t})}function f(t){return Object(a["$next"])().get("".concat(i,"/community/discussion/my/reply/item/").concat(t))}function b(t){return Object(a["$next"])().delete("".concat(i,"/community/discussion/my/reply/item/").concat(t))}function h(t,n){return Object(a["$next"])().put("".concat(i,"/community/discussion/my/reply/item/").concat(t),n)}function g(t){return Object(a["$next"])().get("".concat(i,"/community/discussion/my/comment/list"),{params:t})}function v(t){return Object(a["$next"])().delete("".concat(i,"/community/discussion/my/comment/item/").concat(t))}function y(t,n){var e=t.id,c=t.category,s=t.subcategory,o=void 0===s?"default":s;return Object(a["$next"])().get("".concat(i,"/userdata/common-read-history/").concat(c,"/").concat(o,"/").concat(e),{params:n})}},c355:function(t,n,e){},c680:function(t,n,e){"use strict";e("c355")},fa01:function(t){t.exports=JSON.parse('{"publish":"公开","draft":"草稿","pending":"待审核","dustbin":"已删除"}')},fb92:function(t,n,e){"use strict";e("99af");function a(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",e=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.getFullYear(),c=t.getMonth()+1,s=t.getDate(),o=e?"".concat(a).concat(n).concat(i(c)).concat(n).concat(i(s)):"".concat(a).concat(n).concat(c).concat(n).concat(s);return o}function i(t){return t<10?"0"+t:t}n["a"]=a}}]);