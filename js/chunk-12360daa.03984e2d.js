(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12360daa"],{"01ea":function(t,e,a){"use strict";a.d(e,"k",(function(){return c})),a.d(e,"h",(function(){return o})),a.d(e,"j",(function(){return r})),a.d(e,"g",(function(){return u})),a.d(e,"q",(function(){return d})),a.d(e,"c",(function(){return p})),a.d(e,"b",(function(){return l})),a.d(e,"m",(function(){return _})),a.d(e,"e",(function(){return h})),a.d(e,"f",(function(){return m})),a.d(e,"l",(function(){return f})),a.d(e,"r",(function(){return b})),a.d(e,"d",(function(){return g})),a.d(e,"i",(function(){return v})),a.d(e,"n",(function(){return k})),a.d(e,"o",(function(){return y})),a.d(e,"p",(function(){return w})),a.d(e,"a",(function(){return C})),a.d(e,"t",(function(){return $}));var s=a("5530"),n=a("65c2"),i=Object(s["a"])(Object(s["a"])({},n),{},{__dataPath:"https://data.jx3box.com/",__imgPath:"https://img.jx3box.com/",__iconPath:"https://icon.jx3box.com/"}),c=i.__imgPath,o=i.__dataPath,r=i.__iconPath,u=i.__cms,d=(i.__down,i.__node,i.__ossMirror,i.__ossRoot,i.__visibleMap),p=(i.default_avatar,i.__Root),l=i.__OriginRoot,_=(i.__Github,i.__Preview,i.__server),h=(i.__sso,i.__spider,i.__spider2,i.__next,i.__pay,i.__team,i.__lua,i.__dbm,i.__helperUrl,i.__os,i.__jx3,i.__cdn),m=(i.__staticPath,i.__clients),f=i.__postType,b=i.__wikiType,g=i.__appType,v=i.__gameType,k=(i.__sourceType,i.__userGroup),y=i.__userLevel,w=i.__userLevelColor,C=i.__Links,$=i.feedback;e["s"]=i},1031:function(t,e,a){"use strict";a("eb9a")},"500d":function(t,e,a){"use strict";a.d(e,"a",(function(){return c}));var s=a("41cb");const n=(t,e)=>Object(s["$node"])().get("/pet/"+t,{params:e}),i=location.href.includes("origin")?"origin":"std",c={latest({type:t},e){return Object(s["$cms"])().get("/api/cms/wiki/post/latest",{params:{client:i,...e,type:t}})},mine(t){return Object(s["$cms"])().get("/api/cms/wiki/post/mine",{params:t})},counter({type:t},e){return Object(s["$cms"])().get("/api/cms/wiki/post/counter",{params:{client:i,...e,type:t}})},achievements(t){return Object(s["$node"])().get("/achievement/list",{params:{client:i,...t}})},get({type:t,id:e},a){return Object(s["$cms"])().get(`/api/cms/wiki/post/type/${t}/source/${e}`,{params:{client:i,...a}})},getById(t){return Object(s["$cms"])().get("/api/cms/wiki/post/id/"+t)},post(t){return Object(s["$cms"])().post("/api/cms/wiki/post",t)},update(t,e){return Object(s["$cms"])().put("/api/cms/wiki/post/"+t,e)},remove(t){return Object(s["$cms"])().delete("/api/cms/wiki/post/"+t)},versions({type:t,id:e},a){return Object(s["$cms"])().get(`/api/cms/wiki/post/type/${t}/source/${e}/versions`,{params:{client:i,...a}})},async handleMix(t,e,a,s){let n="",i="",c=!0,o=!1,r=[];if("std"===a){const u=await this.get({type:t,id:e},{client:a,...s});return n=u.data.data.post,i=u.data.data.source,r=u.data.data.users,n&&(c=!1),console.log("获取旗舰攻略"),{post:n,source:i,isEmpty:c,compatible:o,type:t,source_id:e,users:r}}{const u=await this.get({type:t,id:e},{client:a,...s});i=u.data.data.source,n=u.data.data.post,r=u.data.data.users,n&&(c=!1),console.log("获取缘起攻略");const d=!!u.data.data.post;return d?{post:n,source:i,isEmpty:c,compatible:o,type:t,source_id:e,users:r}:(console.log("兼容：获取旗舰攻略"),this.get({type:t,id:e},{client:"std",...s}).then(a=>(n=a.data.data.post,i||(i=a.data.data.source),n&&(c=!1),r=a.data.data.users,o=!0,{post:n,source:i,isEmpty:c,compatible:o,type:t,source_id:e,users:r})))}},async mix({type:t,id:e,client:a},s){let i="",c="";if(i="cj"===t?"achievement":"pet"===t?"item":t||"achievement",e){if(c=e,"pet"===t){const t=await n(e,{client:a});let c=t.data,o=c.ItemTabType+"_"+c.ItemTabIndex;return this.handleMix(i,o,a,s)}return this.handleMix(i,c,a,s)}}}},"5d94":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"m-dashboard m-dashboard-work m-dashboard-wiki"},[e("div",{staticClass:"m-dashboard-work-header"},[e("h2",{staticClass:"u-title"},[t._v(t._s(t.typeLabel)+"百科")]),e("a",{staticClass:"u-publish el-button el-button--primary el-button--small",attrs:{href:t.publishLink}},[e("i",{staticClass:"el-icon-document"}),t._v(" 发布作品")])]),e("el-input",{staticClass:"m-dashboard-work-search u-source-search",attrs:{placeholder:"请输入搜索内容"},on:{change:t.search_post},model:{value:t.achievement_post.keyword,callback:function(e){t.$set(t.achievement_post,"keyword",e)},expression:"achievement_post.keyword"}},[e("template",{slot:"prepend"},[t._v("关键词")]),e("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.search_post},slot:"append"})],2),e("div",{staticClass:"m-dashboard-box"},[t.achievement_post.data&&t.achievement_post.data.length?e("ul",{staticClass:"m-dashboard-box-list"},t._l(t.achievement_post.data,(function(a,s){return e("li",{key:s,staticClass:"u-wiki"},[e("span",{staticClass:"u-tab",domProps:{textContent:t._s(t.getTypeLabel(a.type))}}),e("div",{staticClass:"u-header"},[e("a",{staticClass:"u-title",attrs:{target:"_blank",href:t.getLink(a)}},[t._v(" "+t._s(a.title||"无标题")+" ")]),0==a.checked?e("span",{staticClass:"u-mark pending"},[t._v("⌛ 等待审核")]):t._e(),1==a.checked?e("span",{staticClass:"u-mark"},[t._v("✔ 审核通过")]):t._e(),2==a.checked?e("span",{staticClass:"u-mark reject"},[t._v("❌ 审核驳回")]):t._e(),3==a.checked?e("span",{staticClass:"u-mark hold"},[t._v("🔐 等待验证")]):t._e()]),e("div",{staticClass:"u-desc"},[2==a.checked&&a.check_remark?e("span",{staticClass:"u-check_remark",domProps:{innerHTML:t._s("驳回理由：".concat(a.check_remark))}}):t._e(),e("time",{staticClass:"u-desc-subitem"},[e("i",{staticClass:"el-icon-finished"}),t._v(" 发布 : "+t._s(t._f("dateFormat")(new Date(1e3*a.created)))+" ")]),e("time",{staticClass:"u-desc-subitem"},[e("i",{staticClass:"el-icon-refresh"}),t._v(" 更新 : "+t._s(t._f("dateFormat")(new Date(1e3*a.updated)))+" ")])]),e("el-button-group",{staticClass:"u-action"},[e("el-button",{attrs:{size:"mini",icon:"el-icon-edit",disabled:1==a.checked||3==a.checked,title:"编辑"},on:{click:function(e){return t.post_edit(a)}}}),e("el-button",{attrs:{size:"mini",icon:"el-icon-delete",title:"删除"},on:{click:function(e){return t.post_del(a)}}})],1)],1)})),0):e("el-alert",{staticClass:"m-dashboard-box-null",attrs:{title:"没有找到相关条目",type:"info",center:"","show-icon":""}}),e("el-pagination",{staticClass:"m-dashboard-box-pages",attrs:{background:"",total:t.achievement_post.total,"hide-on-single-page":"",layout:"total, prev, pager, next, jumper","current-page":t.post_page,"page-size":t.length},on:{"current-change":t.post_page_change}})],1)],1)},n=[],i=a("5530"),c=(a("99af"),a("14d9"),a("d3b7"),a("85e4")),o=a("01ea"),r=a("fb92"),u=a("500d"),d=Object(i["a"])(Object(i["a"])({},o["r"]),{},{skill:"技能"}),p={name:"wiki",props:[],data:function(){return{loading:!1,active_name:this.$route.query.type?this.$route.query.type:"wiki_post",achievement_post:{data:null,total:0,keyword:null},post_page:1,length:10}},computed:{type:function(){return this.$route.params.type},typeLabel:function(){return d[this.type]},publishLink:function(){return"/publish/#/"+this.type}},methods:{getTypeLabel:function(t){return t?d[t]:"未知"},post_page_change:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.post_page=e,this.loading=!0,u["a"].mine({type:this.type,_search:this.achievement_post.keyword,page:e,per:this.length}).then((function(e){t.achievement_post.data=e.data.data.list||[],t.achievement_post.total=e.data.data.total||0})).finally((function(){t.loading=!1}))},search_post:function(){this.post_page_change(1)},post_edit:function(t){this.$router.push({path:"/".concat(this.type,"/").concat(t.source_id,"?post_id=").concat(t.id)})},post_del:function(t){var e=this;this.$confirm("确认删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",beforeClose:function(a,s,n){"confirm"===a?u["a"].remove(t.id).then((function(){e.$message.success("删除成功"),e.post_page_change(),n()})):n()}}).catch((function(){}))},getLink:function(t){return Object(c["getLink"])(null===t||void 0===t?void 0:t.type,null===t||void 0===t?void 0:t.source_id)+"/"+(null===t||void 0===t?void 0:t.id)}},filters:{dateFormat:function(t){return Object(r["a"])(new Date(t))}},watch:{$route:{immediate:!0,handler:function(){if(this.$route.params.type){switch(this.$route.query.type){case"wiki_post":this.achievement_post.keyword=this.$route.params.type;break;case"wiki_comment":this.achievement_comment.keyword=this.$route.params.type;break}this.$nextTick((function(){for(var t=document.querySelectorAll(".u-source-search input"),e=0;e<t.length;e++)t[e].value=""}))}else this.achievement_post.keyword="",this.achievement_comment.keyword="";this.post_page_change()}}}},l=p,_=(a("1031"),a("2877")),h=Object(_["a"])(l,s,n,!1,null,null,null);e["default"]=h.exports},eb9a:function(t,e,a){},fb92:function(t,e,a){"use strict";a("99af");function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=t.getFullYear(),i=t.getMonth()+1,c=t.getDate(),o=a?"".concat(s).concat(e).concat(n(i)).concat(e).concat(n(c)):"".concat(s).concat(e).concat(i).concat(e).concat(c);return o}function n(t){return t<10?"0"+t:t}e["a"]=s}}]);