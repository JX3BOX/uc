(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-755a0237"],{"0541":function(t,e,i){"use strict";var a=i("23e7"),s=i("1a2d");a({target:"Object",stat:!0},{hasOwn:s})},"0d10":function(t,e,i){},1740:function(t,e,i){"use strict";i("7475")},2731:function(t,e,i){"use strict";i("b67e")},"2a17":function(t,e,i){"use strict";i("0d10")},6168:function(t,e,i){"use strict";i.d(e,"c",(function(){return c})),i.d(e,"b",(function(){return o})),i.d(e,"a",(function(){return r}));var a=i("c7eb"),s=i("1da1"),n=i("41cb");function c(t,e){return Object(n["$cms"])().post("/api/cms/user/my/meta?key=".concat(t),e)}function o(t){return Object(n["$cms"])().get("/api/cms/config",{params:t}).then((function(t){return t.data.data}))}function r(t){return l.apply(this,arguments)}function l(){return l=Object(s["a"])(Object(a["a"])().mark((function t(e){var i,s,c;return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(n["$cms"])().get("/api/cms/breadcrumb/".concat(e));case 2:return c=t.sent,t.abrupt("return",(null===c||void 0===c||null===(i=c.data)||void 0===i||null===(s=i.data)||void 0===s?void 0:s.html)||"");case 4:case"end":return t.stop()}}),t)}))),l.apply(this,arguments)}},6622:function(t){t.exports=JSON.parse('[{"name":"全部","key":"","icon":"el-icon-menu"},{"name":"实物","key":"entity","icon":"el-icon-s-goods","sub_category":[{"name":"定制纪念品","key":"jdt"},{"name":"其它","key":"other"}]},{"name":"虚拟","key":"virtual","icon":"el-icon-s-ticket","sub_category":[{"name":"主题装扮","key":"skin"},{"name":"魔卡","key":"palu"},{"name":"头像框","key":"avatar"},{"name":"表情包","key":"emotion"}]},{"name":"系统","key":"system","icon":"el-icon-s-finance","sub_category":[{"name":"专业版","key":"vip","link":"/vip/premium","target":"_blank"},{"name":"改名卡","key":"rename2","link":"/vip/rename","target":"_blank"},{"name":"铭牌","key":"namespace2","link":"/vip/namespace","target":"_blank"},{"name":"点月卡","key":"dianyueka","link":"https://charge.xoyo.com/pay?item=jx3&__from=jx3box","target":"_blank"}]}]')},7475:function(t,e,i){},"829d":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("Header",{key:t.currentKey}),e("Breadcrumb",{attrs:{name:"积分商城",slug:"mall",root:"/vip/mall",publishEnable:!1,adminEnable:!1,feedbackEnable:!0}},[e("svg",{attrs:{slot:"logo",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 489.4 489.4","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"},slot:"logo"},[e("path",{attrs:{d:"M347.7 263.75h-66.5c-18.2 0-33 14.8-33 33v51c0 18.2 14.8 33 33 33h66.5c18.2 0 33-14.8 33-33v-51c0-18.2-14.8-33-33-33zm9 84c0 5-4.1 9-9 9h-66.5c-5 0-9-4.1-9-9v-51c0-5 4.1-9 9-9h66.5c5 0 9 4.1 9 9v51z"}}),e("path",{attrs:{d:"M489.4 171.05c0-2.1-.5-4.1-1.6-5.9l-72.8-128c-2.1-3.7-6.1-6.1-10.4-6.1H84.7c-4.3 0-8.3 2.3-10.4 6.1l-72.7 128c-1 1.8-1.6 3.8-1.6 5.9 0 28.7 17.3 53.3 42 64.2v211.1c0 6.6 5.4 12 12 12h381.3c6.6 0 12-5.4 12-12v-209.6c0-.5 0-.9-.1-1.3 24.8-10.9 42.2-35.6 42.2-64.4zM91.7 55.15h305.9l56.9 100.1H34.9l56.8-100.1zm256.6 124c-3.8 21.6-22.7 38-45.4 38s-41.6-16.4-45.4-38h90.8zm-116.3 0c-3.8 21.6-22.7 38-45.4 38s-41.6-16.4-45.5-38H232zm-207.2 0h90.9c-3.8 21.6-22.8 38-45.5 38-22.7.1-41.6-16.4-45.4-38zm176.8 255.2h-69v-129.5c0-9.4 7.6-17.1 17.1-17.1h34.9c9.4 0 17.1 7.6 17.1 17.1v129.5h-.1zm221.7 0H225.6v-129.5c0-22.6-18.4-41.1-41.1-41.1h-34.9c-22.6 0-41.1 18.4-41.1 41.1v129.6H66v-193.3c1.4.1 2.8.1 4.2.1 24.2 0 45.6-12.3 58.2-31 12.6 18.7 34 31 58.2 31s45.5-12.3 58.2-31c12.6 18.7 34 31 58.1 31 24.2 0 45.5-12.3 58.1-31 12.6 18.7 34 31 58.2 31 1.4 0 2.7-.1 4.1-.1v193.2zm-4.1-217.1c-22.7 0-41.6-16.4-45.4-38h90.9c-3.9 21.5-22.8 38-45.5 38z"}})]),e("el-badge",{directives:[{name:"show",rawName:"v-show",value:t.showCart,expression:"showCart"}],staticClass:"u-cart",class:t.isLogin?"":"is-disabled",attrs:{slot:"op-append",id:"shopCart",value:t.cartNum,max:99,hidden:!t.cartNum},slot:"op-append"},[e("i",{staticClass:"el-icon-shopping-cart-full u-icon",on:{click:t.openCart}})])],1),e("LeftSidebar",[e("Nav",{staticClass:"m-nav"})],1),e("Main",{staticClass:"m-vip-container",attrs:{withoutRight:!0}},[e("div",{staticClass:"m-vip-mall"},[t.$route.meta.keepAlive?[e("keep-alive",[e("router-view")],1)]:e("router-view")],2),e("Footer")],1),t.cartVisible?e("Cart"):t._e()],1)},s=[],n=i("c7eb"),c=i("1da1"),o=(i("b0c0"),i("9911"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-mall-nav"},[t.showLottery?e("a",{staticClass:"u-lottery-link",attrs:{href:t.lotteryLink,target:"_blank"}},[e("el-image",{attrs:{src:t.lottery,lazy:"",fit:"cover"}})],1):t._e(),e("div",{staticClass:"m-mall-profile"},[e("el-divider",[t._v("当前资产")]),e("div",{staticClass:"u-credit u-level"},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"经验仅可通过日常签到与社区互动获取",placement:"top"}},[e("div",{staticClass:"u-credit-name"},[e("i",{staticClass:"el-icon-user"}),t._v(" 等级")])]),e("div",{staticClass:"u-credit-value"},[e("b",[t._v("Lv."+t._s(t.level))])])],1),t._l(t.assets,(function(i){return e("div",{key:i.value,staticClass:"u-credit",class:"u-".concat(i.value)},[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:i.tip,placement:"top"}},[e("div",{staticClass:"u-credit-name"},[e("i",{class:i.icon}),t._v(" "+t._s(i.label)),e("em",[t._v("（"+t._s(i.sub_label)+"）")])])]),e("div",{staticClass:"u-credit-value"},[e("b",[t._v(t._s(t.asset[i.value]))])])],1)}))],2),e("div",{staticClass:"m-mall-types"},t._l(t.types,(function(i,a){return e("div",{key:a,staticClass:"u-item"},["system"!=i.key?e("router-link",{staticClass:"u-title",class:t.category==i.key?"active":"",attrs:{to:{name:"mall_list",query:{category:i.key,sub_category:""}}},nativeOn:{click:function(e){return t.itemLinkClick(i.key)}}},[e("i",{staticClass:"u-icon",class:i.icon}),t._v(" "+t._s(i.name)+" ")]):e("span",{staticClass:"u-title",class:t.category==i.key?"active":"",staticStyle:{cursor:"default"}},[e("i",{staticClass:"u-icon",class:i.icon}),t._v(" "+t._s(i.name))]),"system"!=i.key?e("div",{staticClass:"u-children-list"},t._l(i.sub_category,(function(a,s){return e("router-link",{key:s,staticClass:"u-child",class:t.sub_category==a.key?"active":"",attrs:{to:{name:"mall_list",query:{category:i.key,sub_category:a.key}}},nativeOn:{click:function(e){return t.childLinkClick(i.key,a.key)}}},[e("i",{staticClass:"u-arrow el-icon-arrow-right"}),t._v(" "+t._s(a.name)+" ")])})),1):e("div",{staticClass:"u-children-list"},t._l(i.sub_category,(function(i,a){return e("a",{key:a,staticClass:"u-child",class:t.sub_category==i.key||t.sub_category==i.key?"active":"",attrs:{href:i.link,target:i.target}},[e("i",{staticClass:"u-arrow el-icon-arrow-right"}),t._v(" "+t._s(i.name)+" ")])})),0)],1)})),0)])}),r=[],l=i("6622"),u=i("c9d2"),d=i("6168"),m=i("65c2"),v={name:"GoodsNav",data:function(){return{types:l,asset:{experience:0,cny:0,box_coin:0,points:0,red_packet:0},isLogin:u["a"].isLogin(),category:"",sub_category:"",assets:[{label:"盒币",sub_label:"= 通宝",value:"box_coin",tip:"1盒币可用于兑换1通宝，通过评审团/用户打赏获取",icon:"el-icon-coin"},{label:"积分",value:"points",sub_label:"= 银铛",tip:"积分可用于兑换限量纪念品，主要通过日常签到与社区互动获取",icon:"el-icon-sugar"}],showLottery:!1}},computed:{levelStyle:function(){return{background:m["__userLevelColor"][this.level],color:"#fff",padding:"0 8px",borderRadius:"2px"}},level:function(){return u["a"].getLevel(this.asset.experience)},lotteryLink:function(){return m["__Root"]+"vip/lottery"},lottery:function(){return m["__cdn"]+"design/event/lottery/lottery.png"}},watch:{$route:{deep:!0,immediate:!0,handler:function(t){var e,i;this.category=(null===(e=t.query)||void 0===e?void 0:e.category)||"",this.sub_category=(null===(i=t.query)||void 0===i?void 0:i.sub_category)||""}}},methods:{loadAsset:function(){var t=this;u["a"].getAsset().then((function(e){t.asset=e}))},itemLinkClick:function(t){this.category=t},childLinkClick:function(t,e){this.category=t,this.sub_category=e},loadConfig:function(){var t=this;Object(d["b"])({key:"mall_lottery_pic"}).then((function(e){t.showLottery="0"!=(null===e||void 0===e?void 0:e.val)}))}},mounted:function(){u["a"].isLogin()&&this.loadAsset(),this.loadConfig()}},h=v,p=(i("1740"),i("2877")),_=Object(p["a"])(h,o,r,!1,null,null,null),f=_.exports,b=function(){var t=this,e=t._self._c;return e("el-dialog",{staticClass:"m-page-cart",attrs:{visible:t.visible,width:"60%",title:"购物车"},on:{close:t.close}},[e("div",{staticClass:"m-carts"},[e("div",{staticClass:"m-cart-item"},[e("el-checkbox",{staticClass:"u-check-all",on:{change:t.allChange},model:{value:t.isAll,callback:function(e){t.isAll=e},expression:"isAll"}},[t._v("全选")]),t.number?e("el-button",{attrs:{type:"info",plain:"",size:"mini",icon:"el-icon-delete"},on:{click:t.handleClear}},[t._v("清空")]):t._e()],1),t._l(t.list,(function(i){return e("div",{key:i.id,staticClass:"m-cart-item"},[e("div",{staticClass:"m-left"},[e("el-checkbox",{attrs:{disabled:!i.can_buy},on:{change:function(e){return t.itemChecked(i.goods,e)}},model:{value:i.checked,callback:function(e){t.$set(i,"checked",e)},expression:"item.checked"}}),e("div",{staticClass:"m-info",class:i.can_buy?"":"is-disabled",on:{click:function(e){return t.toItem(i.goods)}}},[e("img",{staticClass:"u-frame",attrs:{src:t.showCover(i.goods),fit:"contain"}}),e("div",{staticClass:"u-info"},[e("div",{staticClass:"u-title"},[t._v(" "+t._s(i.goods.title)+" ")]),e("div",{staticClass:"u-exchange"},[e("span",[t._v("等级： Lv."+t._s(t.showLevel(i.goods.exp_limit)))]),e("span",{directives:[{name:"show",rawName:"v-show",value:i.goods.vip_limit,expression:"item.goods.vip_limit"}]},[t._v("仅会员")]),e("span",{directives:[{name:"show",rawName:"v-show",value:i.goods.price_points,expression:"item.goods.price_points"}]},[t._v("积分： "+t._s(i.goods.price_points))]),e("span",{directives:[{name:"show",rawName:"v-show",value:i.goods.price_boxcoin,expression:"item.goods.price_boxcoin"}]},[t._v("盒币： "+t._s(i.goods.price_boxcoin))]),e("span",{directives:[{name:"show",rawName:"v-show",value:i.goods.price_cny,expression:"item.goods.price_cny"}]},[t._v("金箔： "+t._s(i.goods.price_cny))])]),i.can_buy?t._e():e("div",{staticClass:"u-tip"},[t._v(t._s(i.cannot_buy_reason))])])])],1),e("div",{staticClass:"u-amount"},[e("el-input-number",{attrs:{size:"small",max:i.goods.stock},on:{change:function(e){return t.itemChange(i,e)}},model:{value:i.amount,callback:function(e){t.$set(i,"amount",e)},expression:"item.amount"}}),e("el-button",{staticClass:"u-delete",attrs:{circle:"",size:"small",icon:"el-icon-delete"},on:{click:function(e){return e.stopPropagation(),t.deleteGoods(i)}}})],1)])}))],2),e("div",{staticClass:"m-footer",attrs:{slot:"footer"},slot:"footer"},[e("div",{staticClass:"m-info"},[e("div",{staticClass:"u-total"},[e("div",{staticClass:"u-total-label"},[t._v("合计：")]),e("span",{directives:[{name:"show",rawName:"v-show",value:t.all_price_points,expression:"all_price_points"}],staticClass:"u-total-item"},[e("i",{staticClass:"el-icon-sugar"}),e("span",{staticClass:"u-total-value"},[t._v("积分")]),e("b",[t._v(t._s(t.all_price_points))])]),e("span",{directives:[{name:"show",rawName:"v-show",value:t.all_price_boxcoin,expression:"all_price_boxcoin"}],staticClass:"u-total-item"},[e("i",{staticClass:"el-icon-coin"}),e("span",{staticClass:"u-total-value"},[t._v("盒币")]),e("b",[t._v(t._s(t.all_price_boxcoin))])]),e("span",{directives:[{name:"show",rawName:"v-show",value:t.all_price_cny,expression:"all_price_cny"}],staticClass:"u-total-item"},[e("i",{staticClass:"el-icon-wallet"}),e("span",{staticClass:"u-total-value"},[t._v("金箔")]),e("b",[t._v(t._s(t.all_price_cny))])])])]),e("div",{staticClass:"u-op"},[e("el-button",{attrs:{type:"primary",disabled:!t.readyNumber},on:{click:t.toBuy}},[t._v("去结算（"+t._s(t.readyNumber)+"）")])],1)])])},y=[],g=i("5530"),k=(i("4de4"),i("d81d"),i("14d9"),i("13d5"),i("e9f5"),i("d866"),i("910d"),i("ab43"),i("9485"),i("0541"),i("d3b7"),i("85e4")),C=i("2ef0"),w={name:"GoodsCart",data:function(){return{list:[],isAll:!0}},computed:{cartVisible:function(){return this.$store.state.mall.cartVisible},visible:{get:function(){return this.cartVisible},set:function(t){this.$store.commit("mall/SET_STATE",{key:"cartVisible",value:t})}},cart:function(){return this.$store.state.mall.cart},number:function(){return this.list.map((function(t){return t.amount})).reduce((function(t,e){return t+e}),0)},checkedList:function(){return this.list.filter((function(t){return t.checked&&t.can_buy}))},readyNumber:function(){return this.checkedList.map((function(t){return t.amount})).reduce((function(t,e){return t+e}),0)},all_price_points:function(){return this.checkedList.map((function(t){return t.goods.price_points*t.amount})).reduce((function(t,e){return t+e}),0)},all_price_boxcoin:function(){return this.checkedList.map((function(t){return t.goods.price_boxcoin*t.amount})).reduce((function(t,e){return t+e}),0)},all_price_cny:function(){return this.checkedList.map((function(t){return t.goods.price_cny*t.amount})).reduce((function(t,e){return t+e}),0)}},watch:{cart:{immediate:!0,deep:!0,handler:function(t){var e=Object(C["cloneDeep"])(t).map((function(t){return Object(g["a"])(Object(g["a"])({},t),{},{checked:Object.hasOwn(t,"checked")?t.checked:!!t.can_buy})}));this.isAll=e.filter((function(t){return t.can_buy})).every((function(t){return t.checked})),this.list=e}}},methods:{close:function(){this.visible=!1},showCover:function(t){var e=null===t||void 0===t?void 0:t.goods_images[0];return Object(k["getThumbnail"])(e,96)},showLevel:function(t){var e=1;return Object(C["forEach"])(m["__userLevel"],(function(i,a){t>=i[0]&&t<i[1]&&(e=a)})),e},toItem:function(t){this.$router.push({name:"mall_detail",params:{id:t.id}})},itemChange:Object(C["debounce"])((function(t,e){this.$store.dispatch("mall/updateGoodsNum",{shopping_item_id:t.id,amount:e})}),500),itemChecked:function(t,e){t.checked=e,this.$store.commit("mall/SET_STATE",{key:"cart",value:this.list}),this.isAll=!!e&&this.list.every((function(t){return t.checked}))},allChange:function(t){this.list=this.list.map((function(e){return Object(g["a"])(Object(g["a"])({},e),{},{checked:t?!!e.can_buy:t})})),this.$store.commit("mall/SET_STATE",{key:"cart",value:this.list})},deleteGoods:function(t){this.$store.dispatch("mall/deleteCartGoods",t.id)},toBuy:function(){var t=this;return this.readyNumber>15?this.$message({type:"warning",message:"一次性提交商品数量不得超过15个"}):u["a"].isLogin()?void this.$store.dispatch("mall/setCart",this.list).then((function(){t.close(),t.$router.push({name:"mall_batch_order"})})):(this.$message.error("请先登录"),void setTimeout((function(){u["a"].toLogin()}),1e3))},handleClear:function(){var t=this;this.$confirm("你确定要清空购物车吗？","温馨提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$store.dispatch("mall/clearCart")})).catch((function(){}))}}},x=w,L=(i("2731"),Object(p["a"])(x,b,y,!1,null,null,null)),O=L.exports,$={name:"Mall",components:{Nav:f,Cart:O},props:[],data:function(){return{currentKey:0}},computed:{fullPath:function(){return this.$route.fullPath},cartVisible:function(){return this.$store.state.mall.cartVisible},isLogin:function(){return u["a"].isLogin()},cartNum:function(){return this.$store.getters["mall/cartNum"]},showCart:function(){return"mall_batch_order"!==this.$route.name}},methods:{openCart:function(){this.isLogin&&this.$store.commit("mall/SET_STATE",{key:"cartVisible",value:!0})},getBoundCart:function(){var t=document.querySelector("#shopCart"),e=t.getBoundingClientRect();this.$store.commit("mall/SET_STATE",{key:"boundCart",value:e})}},watch:{fullPath:{immediate:!0,handler:function(){this.isLogin&&this.$store.dispatch("mall/getCart")}}},mounted:function(){var t=this;this.isLogin&&this.$nextTick(Object(c["a"])(Object(n["a"])().mark((function e(){var i;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(d["c"])("mall_pop",{val:0});case 2:return e.next=4,Object(d["b"])({key:"mall"});case 4:i=e.sent,localStorage.setItem("mall_pop",i.val),t.currentKey++;case 7:case"end":return e.stop()}}),e)})))),this.getBoundCart();var e=this;window.onresize=function(){e.getBoundCart()}}},j=$,N=(i("2a17"),Object(p["a"])(j,a,s,!1,null,null,null));e["default"]=N.exports},b67e:function(t,e,i){},d866:function(t,e,i){"use strict";var a=i("23e7"),s=i("2266"),n=i("59ed"),c=i("825a"),o=i("46c4");a({target:"Iterator",proto:!0,real:!0},{every:function(t){c(this),n(t);var e=o(this),i=0;return!s(e,(function(e,a){if(!t(e,i++))return a()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})}}]);