(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b1681056"],{"3a86":function(t,s,e){"use strict";e("9753")},"6a5e":function(t,s,e){},"8e42":function(t,s,e){"use strict";e.r(s);var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"m-page-order"},[s("div",{staticClass:"m-breadcrumb"},[s("span",{staticClass:"u-back",on:{click:t.goBack}},[s("i",{staticClass:"el-icon-arrow-left"}),t._v(" 返回")])]),s("div",{staticClass:"m-goods el-card"},[s("div",{staticClass:"m-info"},[s("div",{staticClass:"m-order-step"},[s("el-divider",{attrs:{"content-position":"left"}},[t._v("1. 兑换消耗")]),s("span",{directives:[{name:"show",rawName:"v-show",value:t.all_price_points,expression:"all_price_points"}],staticClass:"u-coin"},[t._v("积分:"),s("b",[t._v(t._s(t.all_price_points))])]),s("span",{directives:[{name:"show",rawName:"v-show",value:t.all_price_boxcoin,expression:"all_price_boxcoin"}],staticClass:"u-coin"},[t._v("盒币:"),s("b",[t._v(t._s(t.all_price_boxcoin))])]),s("span",{directives:[{name:"show",rawName:"v-show",value:t.all_price_cny,expression:"all_price_cny"}],staticClass:"u-coin"},[t._v("金箔:"),s("b",[t._v(t._s(t.all_price_cny))])])],1),s("div",{staticClass:"m-order-step"},[s("el-divider",{attrs:{"content-position":"left"}},[t._v("2. 选择地址")]),s("div",{staticClass:"m-address"},[s("div",{staticClass:"m-button"},[s("el-button",{attrs:{plain:"",type:"primary",icon:"el-icon-sort",size:"small"},on:{click:function(s){t.visible=!0}}},[t._v("选择地址")]),t._m(0)],1),t.address?[s("div",{staticClass:"u-my-address"},[t._m(1),s("div",{staticClass:"u-addr"},[s("span",{staticClass:"u-name"},[t._v(t._s(t.address.contact_name)+" - "+t._s(t.address.contact_phone)+" ")]),s("span",{staticClass:"u-address"},[t._v(" - "+t._s(t.address.province)+t._s(t.address.city)+t._s(t.address.area)+t._s(t.address.address)+" ")])])])]:s("div",[s("el-button",{attrs:{type:"success",icon:"el-icon-plus"}},[t._v("添加地址")])],1)],2)],1),s("div",{staticClass:"m-order-step"},[s("el-divider",{attrs:{"content-position":"left"}},[t._v("3. 备注")]),s("el-input",{attrs:{placeholder:"请输入备注",type:"textarea",rows:2},model:{value:t.remark,callback:function(s){t.remark=s},expression:"remark"}})],1),s("div",{staticClass:"m-op"},[s("el-button",{staticClass:"u-buy",attrs:{type:"primary",loading:t.loading,disabled:!t.ready},on:{click:t.toBuy}},[t._v("支付订单")])],1)])]),s("Address",{attrs:{visible:t.visible},on:{close:t.closeAddress}})],1)},a=[function(){var t=this,s=t._self._c;return s("a",{staticClass:"el-button el-button--small is-plain",attrs:{href:"/dashboard/address",target:"_blank"}},[s("i",{staticClass:"el-icon-setting"}),t._v(" 管理地址")])},function(){var t=this,s=t._self._c;return s("span",{staticClass:"u-label"},[s("i",{staticClass:"el-icon-s-home"}),t._v(" 收货地址")])}],n=(e("4de4"),e("d81d"),e("13d5"),e("e9f5"),e("d866"),e("910d"),e("ab43"),e("9485"),e("d3b7"),e("65c2"),e("921b")),r=e("015f"),o={name:"BatchOrder",data:function(){return{remark:"",visible:!1,loading:!1,checkedList:[]}},components:{Address:n["a"]},computed:{cart:function(){return this.$store.state.mall.cart},readyNumber:function(){return this.checkedList.map((function(t){return t.amount})).reduce((function(t,s){return t+s}),0)},all_price_points:function(){return this.checkedList.map((function(t){return t.goods.price_points*t.amount})).reduce((function(t,s){return t+s}),0)},all_price_boxcoin:function(){return this.checkedList.map((function(t){return t.goods.price_boxcoin*t.amount})).reduce((function(t,s){return t+s}),0)},all_price_cny:function(){return this.checkedList.map((function(t){return t.goods.price_cny*t.amount})).reduce((function(t,s){return t+s}),0)},show_address:function(){return!this.checkedList.every((function(t){var s;return"virtual"===(null===(s=t.goods)||void 0===s?void 0:s.category)}))},address:function(){return this.$store.state.mall.myAddress},asset:function(){return this.$store.state.mall.asset||{}},ready:function(t){t.show_address;var s=t.address,e=t.asset;return(s.contact_name||s.contact_phone||s.province||s.city||s.area||s.address)&&e.box_coin>=this.all_price_boxcoin&&e.points>=this.all_price_points&&e.cny>=this.all_price_cny}},mounted:function(){this.checkedList=this.cart.filter((function(t){return t.checked&&t.can_buy}))},methods:{goBack:function(){this.$router.go(-1)},toBuy:function(){var t=this;this.$alert("你确定支付该订单吗？如需取消可前往个人中心-订单中心处理。","支付确认",{confirmButtonText:"确定",callback:function(s){if("confirm"==s){var e={remark:t.remark,shopping_car_item_ids:t.checkedList.map((function(t){return t.id}))};e.addr_id=t.address.id,t.loading=!0,Object(r["a"])(e).then((function(s){var e,i,a=(null===(e=s.data)||void 0===e||null===(i=e.data)||void 0===i?void 0:i.order_list)||[],n=a.map((function(t){return t.id}));Object(r["b"])({order_id:n}).then((function(){t.$message({type:"success",message:"下单成功"});var s=t.$loading({lock:!0,text:"跳转中..."});setTimeout((function(){s.close(),t.goBack(),window.open(location.origin+"/dashboard/mall")}),2e3)}))})).finally((function(){t.loading=!1}))}}})},closeAddress:function(){this.visible=!1}}},c=o,l=(e("ff69"),e("2877")),d=Object(l["a"])(c,i,a,!1,null,null,null);s["default"]=d.exports},"921b":function(t,s,e){"use strict";var i=function(){var t=this,s=t._self._c;return s("el-dialog",{attrs:{title:"切换地址",visible:t.show,width:"60%","custom-class":"m-goods-address","before-close":t.close,"append-to-body":""},on:{"update:visible":function(s){t.show=s}}},[t.list&&t.list.length?s("el-radio-group",{staticClass:"m-box",model:{value:t.id,callback:function(s){t.id=s},expression:"id"}},t._l(t.list,(function(e,i){return s("el-radio",{key:i,attrs:{label:e.id,border:""}},[s("div",{staticClass:"m-card"},[s("span",[t._v(t._s(e.contact_name))]),s("span",[t._v("电话："+t._s(e.contact_phone))]),s("span",[t._v("地址："+t._s(e.province)+t._s(e.city)+t._s(e.area)+t._s(e.address))])])])})),1):s("a",{staticClass:"m-card m-no-address",attrs:{href:"/dashboard/address",target:"_blank"}},[t._v(" 没有可切换的地址，点击管理地址 ")]),s("span",{staticClass:"m-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:t.close}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)],1)},a=[],n={name:"GoodsAddress",emits:["close"],props:["data","visible"],data:function(){return{show:!1,id:0}},computed:{list:function(){return this.$store.state.mall.addressList}},watch:{visible:function(t){this.show=t}},methods:{close:function(){this.show=!1,this.$emit("close")},submit:function(){this.$store.dispatch("mall/changeAddress",this.id),this.close()}},mounted:function(){this.$store.dispatch("mall/getAddressList")}},r=n,o=(e("3a86"),e("2877")),c=Object(o["a"])(r,i,a,!1,null,null,null);s["a"]=c.exports},9753:function(t,s,e){},d866:function(t,s,e){"use strict";var i=e("23e7"),a=e("2266"),n=e("59ed"),r=e("825a"),o=e("46c4");i({target:"Iterator",proto:!0,real:!0},{every:function(t){r(this),n(t);var s=o(this),e=0;return!a(s,(function(s,i){if(!t(s,e++))return i()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},ff69:function(t,s,e){"use strict";e("6a5e")}}]);