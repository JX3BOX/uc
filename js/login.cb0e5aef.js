(function(t){function e(e){for(var a,r,o=e[0],l=e[1],c=e[2],d=0,p=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&p.push(s[r][0]),s[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);u&&u(e);while(p.length)p.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var t,e=0;e<n.length;e++){for(var i=n[e],a=!0,o=1;o<i.length;o++){var l=i[o];0!==s[l]&&(a=!1)}a&&(n.splice(e--,1),t=r(r.s=i[0]))}return t}var a={},s={login:0},n=[];function r(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=a,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(i,a,function(e){return t[e]}.bind(null,a));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="https://cdn.jx3box.com/static/uc/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;n.push([4,"chunk-vendors","chunk-common"]),i()})({4:function(t,e,i){t.exports=i("90c8")},"90c8":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var a=i("2b0e"),s=i("5c96"),n=i.n(s),r=(i("6b30"),i("c5b4"),i("0af6")),o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"m-card",attrs:{id:"app"}},[e("el-card",{staticClass:"box-card"},[e("CardHeader"),e("Msg"),!t.isLogin||t.isAlternate?[null==t.success?e("main",{staticClass:"m-main"},[e("form",{ref:"loginForm"},[e("div",{staticClass:"u-email"},[e("el-input",{staticClass:"u-text u-email",attrs:{placeholder:"邮箱地址",minlength:"3",maxlength:"50"},on:{change:t.checkEmail},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}},[e("template",{slot:"prepend"},[e("i",{staticClass:"el-icon-message"})])],2),e("div",{staticClass:"u-tip"},[e("el-alert",{directives:[{name:"show",rawName:"v-show",value:0==t.email_validate,expression:"email_validate == false"}],attrs:{title:t.email_validate_tip,type:"error","show-icon":"",closable:!1}})],1)],1),e("div",{staticClass:"u-pass"},[e("el-input",{staticClass:"u-text",attrs:{placeholder:"输入密码","show-password":""},on:{input:t.checkPass},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit.apply(null,arguments)}},model:{value:t.pass,callback:function(e){t.pass=e},expression:"pass"}},[e("template",{slot:"prepend"},[e("i",{staticClass:"el-icon-lock"})])],2),e("div",{staticClass:"u-tip"},[e("el-alert",{directives:[{name:"show",rawName:"v-show",value:0==t.pass_validate,expression:"pass_validate == false"}],attrs:{title:t.pass_validate_tip,type:"error","show-icon":"",closable:!1}})],1)],1),e("el-button",{staticClass:"u-submit u-button",attrs:{type:"primary"},on:{click:t.submit}},[t._v("登录")])],1),e("Union",{attrs:{mode:"login",includes:["qq","wechat","weibo"]}}),e("footer",{staticClass:"m-footer"},[e("p",{staticClass:"u-login"},[t._v(" 还没有账号? "),e("a",{attrs:{href:t.register_url}},[t._v("立即注册 »")])]),e("p",{staticClass:"u-resetpwd"},[e("a",{attrs:{href:t.reset_url}},[t._v("忘记密码?")])])])],1):t._e(),1==t.success?e("main",{staticClass:"m-main"},[e("el-alert",{attrs:{title:"登录成功",type:"success",description:"欢迎回来(#^.^#)","show-icon":"",closable:!1}}),e("a",{staticClass:"u-skip el-button u-button el-button--primary",attrs:{href:t.redirect}},[t._v(t._s(t.redirect_button))])],1):t._e(),0==t.success?e("main",{staticClass:"m-main"},[e("el-alert",{attrs:{title:"登录失败",type:"error",description:t.errors,"show-icon":"",closable:!1}}),e("el-button",{staticClass:"u-button u-submit",attrs:{type:"primary"},on:{click:t.reset}},[t._v("返回")])],1):t._e()]:[e("div",{staticClass:"m-login-in"},[e("el-alert",{staticClass:"u-current-info",attrs:{type:"warning","show-icon":"",closable:!1,center:""}},[e("span",{attrs:{slot:"title"},slot:"title"},[t._v("已登录为 "),e("b",[t._v(t._s(t.username))])])]),e("el-button",{staticClass:"u-logout",attrs:{type:"danger",size:"medium"},on:{click:t.logout}},[t._v("登 出")])],1)]],2),e("Bottom")],1)},l=[],c=i("5530"),u=(i("b0c0"),i("e9c4"),i("a9e3"),i("d3b7"),i("ac1f"),i("3ca3"),i("841c"),i("ddb0"),i("9861"),i("88a7"),i("271a"),i("5494"),i("c781")),d=i("39c6"),p=i("d174"),f=i("65c2"),h=i("c9d2"),m=i("71e5"),v=i("9945"),_=v.validator,b=i("f3e4"),g={name:"Login",data:function(){return{success:null,redirect:"",redirect_button:"",errors:"未知异常",email:"",email_validate:null,email_validate_tip:"用户名有效长度为3-50个字符",pass:"",pass_validate:null,pass_validate_tip:"密码有效长度为6-50个字符",homepage:f["__Root"],failcount:0,faillimit:10,device_id:"",isLogin:h["a"].isLogin(),username:h["a"].getInfo().name,isAlternate:!1}},computed:{ready:function(){return this.email_validate&&this.pass_validate},register_url:function(){return f["__Links"].account.register+"?redirect="+this.redirect},reset_url:function(){return"/account/password_rest"}},methods:{checkEmail:function(){if(""!=this.email){var t=_(this.email,{len:[3,50]});this.email_validate=t}else this.email_validate=!1},checkPass:function(){if(""!=this.pass){var t=_(this.pass,{len:[6,50]});this.pass_validate=t}else this.pass_validate=!1},submit:function(){var t=this;this.isfrozen()||(this.ready||(this.checkPass(),this.checkEmail()),this.ready&&Object(p["b"])({email:this.email,pass:this.pass}).then((function(e){if(e.data.code)t.success=!1,t.errors=e.data.msg,t.failcount++,t.frozen();else{var i,a,s,n,r,o;t.success=!0;var l=e.data.data,u={token:l.token,uid:null===l||void 0===l||null===(i=l.user)||void 0===i?void 0:i.ID,group:(null===l||void 0===l||null===(a=l.user)||void 0===a?void 0:a.user_group)||1,name:null===l||void 0===l||null===(s=l.user)||void 0===s?void 0:s.display_name,status:null===l||void 0===l||null===(n=l.user)||void 0===n?void 0:n.user_status,bind_wx:null!==l&&void 0!==l&&null!==(r=l.user)&&void 0!==r&&r.wechat_unionid?1:0,avatar:(null===l||void 0===l||null===(o=l.user)||void 0===o?void 0:o.user_avatar)||""};h["a"].update(u).then((function(){t.isAlternate&&localStorage.setItem("jx3box-alternate-".concat(u.uid),JSON.stringify(Object(c["a"])(Object(c["a"])({},u),{},{created_at:Number(localStorage.getItem("created_at"))}))),t.skip()})).catch((function(t){alert("浏览器版本太低,不支持本站")}))}})).catch((function(e){t.success=!1,t.errors="网络异常或非法请求"})))},reset:function(){this.success=null,this.email="",this.email_validate=null,this.pass="",this.pass_validate=null},frozen:function(){this.failcount>=this.faillimit&&b.set("loginIsFrozen","true",86400)},isfrozen:function(){return this.failcount>=this.faillimit&&(this.success=!1,this.errors="失败次数过多,请24小时后再试",!0)},checkDirect:function(){var t=new URLSearchParams(document.location.search),e=t.get("redirect");e?(this.redirect=e,this.redirect_button="即将跳转"):(this.redirect=this.homepage,this.redirect_button="返回首页");var i=t.get("alternate");~~i&&(this.isAlternate=!0,sessionStorage.setItem("alternate",1))},checkDeviceID:function(){h["a"].generateFingerprint()},skip:function(){var t=this;this.redirect&&setTimeout((function(){location.href=decodeURIComponent(t.redirect)}),1200)},logout:function(){h["a"].destroy().then((function(){location.reload()}))}},filters:{},mounted:function(){this.checkDirect()},created:function(){this.checkDeviceID()},components:{CardHeader:u["a"],Union:d["a"],Msg:m["a"]}},y=g,k=(i("cdb5"),i("2877")),w=Object(k["a"])(y,o,l,!1,null,null,null),C=w.exports;a["default"].config.productionTip=!1,a["default"].use(n.a),a["default"].component("Bottom",r["a"]),new a["default"]({render:function(t){return t(C)}}).$mount("#app")},ccb8:function(t,e,i){},cdb5:function(t,e,i){"use strict";i("ccb8")},f3e4:function(t,e,i){function a(t,e,i){document.cookie=t+"="+e+"; Max-Age="+i}function s(t,e){document.cookie=t+"="+e+"; Max-Age=0"}function n(t){t+="=";for(var e=document.cookie.split(";"),i=0;i<e.length;i++){var a=e[i].trim();if(0==a.indexOf(t))return a.slice(t.length,t.length)}return""}i("fb6a"),i("498a"),t.exports={get:n,set:a,del:s}}});